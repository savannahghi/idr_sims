from airflow import DAG
from airflow import models
from airflow.contrib.operators.bigquery_operator import BigQueryOperator
from datetime import datetime, timedelta

PROJECT_ID= models.Variable.get("PROJECT_ID")
STAGING_DATASET = "SIMS_test"
LOCATION = "eu"
gcp_conn = "google_cloud_default"

default_args = {
    'owner': 'SGHI',
    'depends_on_past': False,
    'start_date': datetime(2022,10,15),
    'email_on_failure': False,
    'email_on_retry': False,
    'retries': 2,
    'retry_delay': timedelta(minutes=3),
  }

with DAG("sims_transforms",schedule_interval=None, default_args=default_args) as dag:
    t1 = BigQueryOperator(
        task_id='S1A_hubs',
        sql=f'''
        SELECT
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASSR_NAME,	
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_COUNTY,	
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_SUB_COUNTY,	
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_FACILITY,	
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_FACILITY_MFL,	
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_TYPE,	
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_DATE,	
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_START_TIME,	
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_END_TIME,	
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_LOCATION,	
        sets.data_S_01_01_SIMS_S_01_01_BenEng_STANDARD,
        sets.data_S_01_01_SIMS_S_01_01_BenEng_Q1_T_NUM,
        sets.data_S_01_01_SIMS_S_01_01_BenEng_Q2_T_NUM,
        sets.data_S_01_01_SIMS_S_01_01_BenEng_COMM,
        sets.data_S_01_01_SIMS_S_01_01_BenEng_SCORE,
        sets.data_S_01_02_SIMS_S_01_02_CondomAvail_STANDARD,	
        sets.data_S_01_02_SIMS_S_01_02_CondomAvail_Q1_T_NUM,
        sets.data_S_01_02_SIMS_S_01_02_CondomAvail_Q2_RESP,
        sets.data_S_01_02_SIMS_S_01_02_CondomAvail_COMM,
        sets.data_S_01_02_SIMS_S_01_02_CondomAvail_SCORE,
        sets.data_S_01_03_SIMS_S_01_03_PtRights_STANDARD,
        sets.data_S_01_03_SIMS_S_01_03_PtRights_Q1_RESP,
        sets.data_S_01_03_SIMS_S_01_03_PtRights_Q2_RESP,
        sets.data_S_01_03_SIMS_S_01_03_PtRights_Q3_RESP,	
        sets.data_S_01_03_SIMS_S_01_03_PtRights_Q4_T_NUM,
        sets.data_S_01_03_SIMS_S_01_03_PtRights_COMM,
        sets.data_S_01_03_SIMS_S_01_03_PtRights_SCORE,
        sets.data_S_01_04_SIMS_S_01_04_ChSfg_STANDARD,
        sets.data_S_01_04_SIMS_S_01_04_ChSfg_INSTRUCTIONS,
        sets.data_S_01_04_SIMS_S_01_04_ChSfg_NA,
        sets.data_S_01_04_SIMS_S_01_04_ChSfg_Q1_RESP,
        sets.data_S_01_04_SIMS_S_01_04_ChSfg_Q2_RESP,
        sets.data_S_01_04_SIMS_S_01_04_ChSfg_Q3_RESP,
        sets.data_S_01_04_SIMS_S_01_04_ChSfg_COMM,
        sets.data_S_01_04_SIMS_S_01_04_ChSfg_SCORE,
        sets.data_S_01_05_SIMS_S_01_05_StaffPerf_STANDARD,
        sets.data_S_01_05_SIMS_S_01_05_StaffPerf_Q1_RESP,
        sets.data_S_01_05_SIMS_S_01_05_StaffPerf_Q2_T_NUM,	
        sets.data_S_01_05_SIMS_S_01_05_StaffPerf_COMM,	
        sets.data_S_01_05_SIMS_S_01_05_StaffPerf_SCORE,
        sets.data_S_01_06_SIMS_S_01_06_TBInfCon_STANDARD,	
        sets.data_S_01_06_SIMS_S_01_06_TBInfCon_INSTRUCTIONS,	
        sets.data_S_01_06_SIMS_S_01_06_TBInfCon_Q1_T_NUM,
        sets.data_S_01_06_SIMS_S_01_06_TBInfCon_Q2_RESP,	
        sets.data_S_01_06_SIMS_S_01_06_TBInfCon_Q3_RESP,	
        sets.data_S_01_06_SIMS_S_01_06_TBInfCon_COMM,
        sets.data_S_01_06_SIMS_S_01_06_TBInfCon_SCORE,	
        sets.data_S_01_07_SIMS_S_01_07_WasteMan_Gen_STANDARD,
        sets.data_S_01_07_SIMS_S_01_07_WasteMan_Gen_INSTRUCTIONS,	
        sets.data_S_01_07_SIMS_S_01_07_WasteMan_Gen_NA,
        sets.data_S_01_07_SIMS_S_01_07_WasteMan_Gen_Q1_RESP,	
        sets.data_S_01_07_SIMS_S_01_07_WasteMan_Gen_Q2_RESP,	
        sets.data_S_01_07_SIMS_S_01_07_WasteMan_Gen_Q3_T_NUM,
        sets.data_S_01_07_SIMS_S_01_07_WasteMan_Gen_COMM,
        sets.data_S_01_07_SIMS_S_01_07_WasteMan_Gen_SCORE,	
        sets.data_S_01_08_SIMS_S_01_08_InjSafe_Gen_STANDARD,	
        sets.data_S_01_08_SIMS_S_01_08_InjSafe_Gen_INSTRUCTIONS,	
        sets.data_S_01_08_SIMS_S_01_08_InjSafe_Gen_NA,	
        sets.data_S_01_08_SIMS_S_01_08_InjSafe_Gen_Q1_T_NUM,	
        sets.data_S_01_08_SIMS_S_01_08_InjSafe_Gen_Q2_RESP,
        sets.data_S_01_08_SIMS_S_01_08_InjSafe_Gen_Q3_T_NUM,
        sets.data_S_01_08_SIMS_S_01_08_InjSafe_Gen_Q4_RESP,	
        sets.data_S_01_08_SIMS_S_01_08_InjSafe_Gen_COMM,	
        sets.data_S_01_08_SIMS_S_01_08_InjSafe_Gen_SCORE,
        sets.data_S_01_09_SIMS_S_01_09_ProvPrEPServ_STANDARD,
        sets.data_S_01_09_SIMS_S_01_09_ProvPrEPServ_INSTRUCTIONS,
        sets.data_S_01_09_SIMS_S_01_09_ProvPrEPServ_NA,
        sets.data_S_01_09_SIMS_S_01_09_ProvPrEPServ_Q1_RESP,	
        sets.data_S_01_09_SIMS_S_01_09_ProvPrEPServ_Q2_RESP,
        sets.data_S_01_09_SIMS_S_01_09_ProvPrEPServ_Q3_T_NUM,
        sets.data_S_01_09_SIMS_S_01_09_ProvPrEPServ_COMM,
        sets.data_S_01_09_SIMS_S_01_09_ProvPrEPServ_SCORE,
        sets.data_meta_instanceID,	
        sets.data_meta_instanceName,	
        sets.Facility,	
        sets.meta_details,	
        sets.data_S_01_01_SIMS_S_01_01_BenEng_SCORE_grade,	
        sets.data_S_01_02_SIMS_S_01_02_CondomAvail_SCORE_grade,	
        sets.data_S_01_03_SIMS_S_01_03_PtRights_SCORE_grade,	
        sets.data_S_01_04_SIMS_S_01_04_ChSfg_SCORE_grade,
        sets.data_S_01_05_SIMS_S_01_05_StaffPerf_SCORE_grade,
        sets.data_S_01_06_SIMS_S_01_06_TBInfCon_SCORE_grade,
        sets.data_S_01_07_SIMS_S_01_07_WasteMan_Gen_SCORE_grade,
        sets.data_S_01_08_SIMS_S_01_08_InjSafe_Gen_SCORE_grade,
        sets.data_S_01_09_SIMS_S_01_09_ProvPrEPServ_SCORE_grade,	
        sets.Set_Average,	
        sets.Expected_Average,	
        sets.Average_Score,	
        sets.Set_ID, 
        hubs.Hub
        FROM `{PROJECT_ID}.{STAGING_DATASET}.S_1Atest` as sets
        LEFT JOIN `{PROJECT_ID}.MFL.hub_details` as hubs
        ON cast(sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_FACILITY_MFL as int64) = hubs.MFL_Code
        ''',
        destination_dataset_table = f'{PROJECT_ID}:{STAGING_DATASET}.S_1Atest',
        write_disposition='WRITE_TRUNCATE',
        allow_large_results=True,
        use_legacy_sql=False,
        dag=dag
    )

    t2 = BigQueryOperator(
        task_id='S1B_hubs',
        sql=f'''
        SELECT
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASSR_NAME,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_COUNTY,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_SUB_COUNTY,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_FACILITY,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_FACILITY_MFL,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_TYPE,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_DATE,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_START_TIME,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_END_TIME,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_LOCATION,
        sets.data_S_01_10_SIMS_S_01_10_SuppChain_STANDARD,
        sets.data_S_01_10_SIMS_S_01_10_SuppChain_INSTRUCTIONS,
        sets.data_S_01_10_SIMS_S_01_10_SuppChain_NA,
        sets.data_S_01_10_SIMS_S_01_10_SuppChain_Q1_T_NUM,
        sets.data_S_01_10_SIMS_S_01_10_SuppChain_Q2_T_NUM,
        sets.data_S_01_10_SIMS_S_01_10_SuppChain_Q3_RESP,
        sets.data_S_01_10_SIMS_S_01_10_SuppChain_COMM,
        sets.data_S_01_10_SIMS_S_01_10_SuppChain_SCORE,
        sets.data_S_01_11_SIMS_S_01_11_MedDisp_STANDARD,
        sets.data_S_01_11_SIMS_S_01_11_MedDisp_INSTRUCTIONS,
        sets.data_S_01_11_SIMS_S_01_11_MedDisp_NA,
        sets.data_S_01_11_SIMS_S_01_11_MedDisp_Q1_RESP,
        sets.data_S_01_11_SIMS_S_01_11_MedDisp_Q2_RESP,
        sets.data_S_01_11_SIMS_S_01_11_MedDisp_Q3_RESP,
        sets.data_S_01_11_SIMS_S_01_11_MedDisp_COMM,
        sets.data_S_01_11_SIMS_S_01_11_MedDisp_SCORE,
        sets.data_S_01_12_SIMS_S_01_12_SupARV_STANDARD,
        sets.data_S_01_12_SIMS_S_01_12_SupARV_INSTRUCTIONS,
        sets.data_S_01_12_SIMS_S_01_12_SupARV_NA,
        sets.data_S_01_12_SIMS_S_01_12_SupARV_Q1_RESP,
        sets.data_S_01_12_SIMS_S_01_12_SupARV_Q2_RESP,
        sets.data_S_01_12_SIMS_S_01_12_SupARV_Q3_RESP,
        sets.data_S_01_12_SIMS_S_01_12_SupARV_COMM,
        sets.data_S_01_12_SIMS_S_01_12_SupARV_SCORE,
        sets.data_S_01_13_SIMS_S_01_13_SupCTX_STANDARD,
        sets.data_S_01_13_SIMS_S_01_13_SupCTX_INSTRUCTIONS,
        sets.data_S_01_13_SIMS_S_01_13_SupCTX_NA,
        sets.data_S_01_13_SIMS_S_01_13_SupCTX_Q1_RESP,
        sets.data_S_01_13_SIMS_S_01_13_SupCTX_Q2_RESP,
        sets.data_S_01_13_SIMS_S_01_13_SupCTX_Q3_RESP,
        sets.data_S_01_13_SIMS_S_01_13_SupCTX_COMM,
        sets.data_S_01_13_SIMS_S_01_13_SupCTX_SCORE,
        sets.data_S_01_14_SIMS_S_01_14_SupIPT_STANDARD,
        sets.data_S_01_14_SIMS_S_01_14_SupIPT_INSTRUCTIONS,
        sets.data_S_01_14_SIMS_S_01_14_SupIPT_NA,
        sets.data_S_01_14_SIMS_S_01_14_SupIPT_Q1_RESP,
        sets.data_S_01_14_SIMS_S_01_14_SupIPT_Q2_RESP,
        sets.data_S_01_14_SIMS_S_01_14_SupIPT_Q3_RESP,
        sets.data_S_01_14_SIMS_S_01_14_SupIPT_COMM,
        sets.data_S_01_14_SIMS_S_01_14_SupIPT_SCORE,
        sets.data_S_01_15_SIMS_S_01_15_SupPedARV_STANDARD,
        sets.data_S_01_15_SIMS_S_01_15_SupPedARV_INSTRUCTIONS,
        sets.data_S_01_15_SIMS_S_01_15_SupPedARV_NA,
        sets.data_S_01_15_SIMS_S_01_15_SupPedARV_Q1_RESP,
        sets.data_S_01_15_SIMS_S_01_15_SupPedARV_Q2_RESP,
        sets.data_S_01_15_SIMS_S_01_15_SupPedARV_Q3_RESP,
        sets.data_S_01_15_SIMS_S_01_15_SupPedARV_COMM,
        sets.data_S_01_15_SIMS_S_01_15_SupPedARV_SCORE,
        sets.data_S_01_16_SIMS_S_01_16_SupPedCTX_STANDARD,
        sets.data_S_01_16_SIMS_S_01_16_SupPedCTX_INSTRUCTIONS,
        sets.data_S_01_16_SIMS_S_01_16_SupPedCTX_NA,
        sets.data_S_01_16_SIMS_S_01_16_SupPedCTX_Q1_RESP,
        sets.data_S_01_16_SIMS_S_01_16_SupPedCTX_Q2_RESP,
        sets.data_S_01_16_SIMS_S_01_16_SupPedCTX_Q3_RESP,
        sets.data_S_01_16_SIMS_S_01_16_SupPedCTX_COMM,
        sets.data_S_01_16_SIMS_S_01_16_SupPedCTX_SCORE,
        sets.data_S_01_17_SIMS_S_01_17_SupPedIPT_STANDARD,
        sets.data_S_01_17_SIMS_S_01_17_SupPedIPT_INSTRUCTIONS,
        sets.data_S_01_17_SIMS_S_01_17_SupPedIPT_NA,
        sets.data_S_01_17_SIMS_S_01_17_SupPedIPT_Q1_RESP,
        sets.data_S_01_17_SIMS_S_01_17_SupPedIPT_Q2_RESP,
        sets.data_S_01_17_SIMS_S_01_17_SupPedIPT_Q3_RESP,
        sets.data_S_01_17_SIMS_S_01_17_SupPedIPT_COMM,
        sets.data_S_01_17_SIMS_S_01_17_SupPedIPT_SCORE,
        sets.data_S_01_18_SIMS_S_01_18_SupRTK_STANDARD,
        sets.data_S_01_18_SIMS_S_01_18_SupRTK_INSTRUCTIONS,
        sets.data_S_01_18_SIMS_S_01_18_SupRTK_NA,
        sets.data_S_01_18_SIMS_S_01_18_SupRTK_Q1_RESP,
        sets.data_S_01_18_SIMS_S_01_18_SupRTK_Q2_RESP,
        sets.data_S_01_18_SIMS_S_01_18_SupRTK_Q3_RESP,
        sets.data_S_01_18_SIMS_S_01_18_SupRTK_COMM,
        sets.data_S_01_18_SIMS_S_01_18_SupRTK_SCORE,
        sets.data_meta_instanceID,
        sets.data_meta_instanceName,
        sets.Facility,
        sets.meta_details,
        sets.data_S_01_10_SIMS_S_01_10_SuppChain_SCORE_grade,
        sets.data_S_01_11_SIMS_S_01_11_MedDisp_SCORE_grade,
        sets.data_S_01_12_SIMS_S_01_12_SupARV_SCORE_grade,
        sets.data_S_01_13_SIMS_S_01_13_SupCTX_SCORE_grade,
        sets.data_S_01_14_SIMS_S_01_14_SupIPT_SCORE_grade,
        sets.data_S_01_15_SIMS_S_01_15_SupPedARV_SCORE_grade,
        sets.data_S_01_16_SIMS_S_01_16_SupPedCTX_SCORE_grade,
        sets.data_S_01_17_SIMS_S_01_17_SupPedIPT_SCORE_grade,
        sets.data_S_01_18_SIMS_S_01_18_SupRTK_SCORE_grade,
        sets.Set_Average,	
        sets.Expected_Average,	
        sets.Average_Score,	
        sets.Set_ID, 
        hubs.Hub
        FROM `{PROJECT_ID}.{STAGING_DATASET}.S_1Btest` as sets
        LEFT JOIN `{PROJECT_ID}.MFL.hub_details` as hubs
        ON cast(sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_FACILITY_MFL as int64) = hubs.MFL_Code
        ''',
        destination_dataset_table = f'{PROJECT_ID}:{STAGING_DATASET}.S_1Btest',
        write_disposition='WRITE_TRUNCATE',
        allow_large_results=True,
        use_legacy_sql=False,
        dag=dag
    )

    t3 = BigQueryOperator(
        task_id='S1C_hubs',
        sql=f'''
        SELECT
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASSR_NAME,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_COUNTY,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_SUB_COUNTY,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_FACILITY,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_FACILITY_MFL,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_TYPE,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_DATE,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_START_TIME,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_END_TIME,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_LOCATION,
        sets.data_S_01_19_SIMS_S_01_19_DQA_Activities_STANDARD,
        sets.data_S_01_19_SIMS_S_01_19_DQA_Activities_Q1_RESP,
        sets.data_S_01_19_SIMS_S_01_19_DQA_Activities_Q2_T_NUM,
        sets.data_S_01_19_SIMS_S_01_19_DQA_Activities_COMM,
        sets.data_S_01_19_SIMS_S_01_19_DQA_Activities_SCORE,
        sets.data_S_01_20_SIMS_S_01_20_PerfData_STANDARD,
        sets.data_S_01_20_SIMS_S_01_20_PerfData_Q1_RESP,
        sets.data_S_01_20_SIMS_S_01_20_PerfData_Q2_RESP,
        sets.data_S_01_20_SIMS_S_01_20_PerfData_Q3_RESP,
        sets.data_S_01_20_SIMS_S_01_20_PerfData_COMM,
        sets.data_S_01_20_SIMS_S_01_20_PerfData_SCORE,
        sets.data_S_01_21_SIMS_S_01_21_DataRepConTX_STANDARD,
        sets.data_S_01_21_SIMS_S_01_21_DataRepConTX_INSTRUCTIONS,
        sets.data_S_01_21_SIMS_S_01_21_DataRepConTX_NA,
        sets.data_S_01_21_SIMS_S_01_21_DataRepConTX_Q1_RESP,
        sets.data_S_01_21_SIMS_S_01_21_DataRepConTX_Q2_PERC_GRP_generated_table_list_label_34,
        sets.data_S_01_21_SIMS_S_01_21_DataRepConTX_Q2_PERC_GRP_SIMS_S_01_21_DataRepConTX_Q2_PERC,
        sets.data_S_01_21_SIMS_S_01_21_DataRepConTX_Q2_PERC_GRP_SIMS_S_01_21_DataRepConTX_Q2_A,
        sets.data_S_01_21_SIMS_S_01_21_DataRepConTX_Q2_PERC_GRP_SIMS_S_01_21_DataRepConTX_Q2_B,
        sets.data_S_01_21_SIMS_S_01_21_DataRepConTX_Q2_PERC_GRP_SIMS_S_01_21_DataRepConTX_Q2_C,
        sets.data_S_01_21_SIMS_S_01_21_DataRepConTX_Q2_PERC_GRP_SIMS_S_01_21_DataRepConTX_Q2_D,
        sets.data_S_01_21_SIMS_S_01_21_DataRepConTX_COMM,
        sets.data_S_01_21_SIMS_S_01_21_DataRepConTX_SCORE,
        sets.data_S_01_22_SIMS_S_01_22_DataRepConHTS_STANDARD,
        sets.data_S_01_22_SIMS_S_01_22_DataRepConHTS_INSTRUCTIONS,
        sets.data_S_01_22_SIMS_S_01_22_DataRepConHTS_NA,
        sets.data_S_01_22_SIMS_S_01_22_DataRepConHTS_Q1_RESP,
        sets.data_S_01_22_SIMS_S_01_22_DataRepConHTS_Q2_PERC_GRP_generated_table_list_label_49,
        sets.data_S_01_22_SIMS_S_01_22_DataRepConHTS_Q2_PERC_GRP_SIMS_S_01_22_DataRepConHTS_Q2_PERC,
        sets.data_S_01_22_SIMS_S_01_22_DataRepConHTS_Q2_PERC_GRP_SIMS_S_01_22_DataRepConHTS_Q2_A,
        sets.data_S_01_22_SIMS_S_01_22_DataRepConHTS_Q2_PERC_GRP_SIMS_S_01_22_DataRepConHTS_Q2_B,
        sets.data_S_01_22_SIMS_S_01_22_DataRepConHTS_Q2_PERC_GRP_SIMS_S_01_22_DataRepConHTS_Q2_C,
        sets.data_S_01_22_SIMS_S_01_22_DataRepConHTS_Q2_PERC_GRP_SIMS_S_01_22_DataRepConHTS_Q2_D,
        sets.data_S_01_22_SIMS_S_01_22_DataRepConHTS_COMM,
        sets.data_S_01_22_SIMS_S_01_22_DataRepConHTS_SCORE,
        sets.data_S_01_23_SIMS_S_01_23_DataRepConPMTCT_STANDARD,
        sets.data_S_01_23_SIMS_S_01_23_DataRepConPMTCT_INSTRUCTIONS,
        sets.data_S_01_23_SIMS_S_01_23_DataRepConPMTCT_NA,
        sets.data_S_01_23_SIMS_S_01_23_DataRepConPMTCT_Q1_RESP,
        sets.data_S_01_23_SIMS_S_01_23_DataRepConPMTCT_Q2_PERC_GRP_generated_table_list_label_64,
        sets.data_S_01_23_SIMS_S_01_23_DataRepConPMTCT_Q2_PERC_GRP_SIMS_S_01_23_DataRepConPMTCT_Q2_PERC,
        sets.data_S_01_23_SIMS_S_01_23_DataRepConPMTCT_Q2_PERC_GRP_SIMS_S_01_23_DataRepConPMTCT_Q2_A,
        sets.data_S_01_23_SIMS_S_01_23_DataRepConPMTCT_Q2_PERC_GRP_SIMS_S_01_23_DataRepConPMTCT_Q2_B,
        sets.data_S_01_23_SIMS_S_01_23_DataRepConPMTCT_Q2_PERC_GRP_SIMS_S_01_23_DataRepConPMTCT_Q2_C,
        sets.data_S_01_23_SIMS_S_01_23_DataRepConPMTCT_Q2_PERC_GRP_SIMS_S_01_23_DataRepConPMTCT_Q2_D,
        sets.data_S_01_23_SIMS_S_01_23_DataRepConPMTCT_COMM,
        sets.data_S_01_23_SIMS_S_01_23_DataRepConPMTCT_SCORE,
        sets.data_S_01_24_SIMS_S_01_24_DataRepConVMMC_STANDARD,
        sets.data_S_01_24_SIMS_S_01_24_DataRepConVMMC_INSTRUCTIONS,
        sets.data_S_01_24_SIMS_S_01_24_DataRepConVMMC_NA,
        sets.data_S_01_24_SIMS_S_01_24_DataRepConVMMC_Q1_RESP,
        sets.data_S_01_24_SIMS_S_01_24_DataRepConVMMC_Q2_PERC_GRP_generated_table_list_label_79,
        sets.data_S_01_24_SIMS_S_01_24_DataRepConVMMC_Q2_PERC_GRP_SIMS_S_01_24_DataRepConVMMC_Q2_PERC,
        sets.data_S_01_24_SIMS_S_01_24_DataRepConVMMC_Q2_PERC_GRP_SIMS_S_01_24_DataRepConVMMC_Q2_A,
        sets.data_S_01_24_SIMS_S_01_24_DataRepConVMMC_Q2_PERC_GRP_SIMS_S_01_24_DataRepConVMMC_Q2_B,
        sets.data_S_01_24_SIMS_S_01_24_DataRepConVMMC_Q2_PERC_GRP_SIMS_S_01_24_DataRepConVMMC_Q2_C,
        sets.data_S_01_24_SIMS_S_01_24_DataRepConVMMC_Q2_PERC_GRP_SIMS_S_01_24_DataRepConVMMC_Q2_D,
        sets.data_S_01_24_SIMS_S_01_24_DataRepConVMMC_COMM,
        sets.data_S_01_24_SIMS_S_01_24_DataRepConVMMC_SCORE,
        sets.data_meta_instanceID,
        sets.data_meta_instanceName,
        sets.data_S_01_21_SIMS_S_01_21_DataRepConTX_Q2_PERC_generated_table_list_label_34,
        sets.data_S_01_21_SIMS_S_01_21_DataRepConTX_Q2_PERC_SIMS_S_01_21_DataRepConTX_Q2_A,
        sets.data_S_01_21_SIMS_S_01_21_DataRepConTX_Q2_PERC_SIMS_S_01_21_DataRepConTX_Q2_B,
        sets.data_S_01_21_SIMS_S_01_21_DataRepConTX_Q2_PERC_SIMS_S_01_21_DataRepConTX_Q2_C,
        sets.data_S_01_21_SIMS_S_01_21_DataRepConTX_Q2_PERC_SIMS_S_01_21_DataRepConTX_Q2_D,
        sets.data_S_01_22_SIMS_S_01_22_DataRepConHTS_Q2_PERC_generated_table_list_label_48,
        sets.data_S_01_22_SIMS_S_01_22_DataRepConHTS_Q2_PERC_SIMS_S_01_22_DataRepConHTS_Q2_A,
        sets.data_S_01_22_SIMS_S_01_22_DataRepConHTS_Q2_PERC_SIMS_S_01_22_DataRepConHTS_Q2_B,
        sets.data_S_01_22_SIMS_S_01_22_DataRepConHTS_Q2_PERC_SIMS_S_01_22_DataRepConHTS_Q2_C,
        sets.data_S_01_22_SIMS_S_01_22_DataRepConHTS_Q2_PERC_SIMS_S_01_22_DataRepConHTS_Q2_D,
        sets.data_S_01_23_SIMS_S_01_23_DataRepConPMTCT_Q2_PERC_generated_table_list_label_62,
        sets.data_S_01_23_SIMS_S_01_23_DataRepConPMTCT_Q2_PERC_SIMS_S_01_23_DataRepConPMTCT_Q2_A,
        sets.data_S_01_23_SIMS_S_01_23_DataRepConPMTCT_Q2_PERC_SIMS_S_01_23_DataRepConPMTCT_Q2_B,
        sets.data_S_01_23_SIMS_S_01_23_DataRepConPMTCT_Q2_PERC_SIMS_S_01_23_DataRepConPMTCT_Q2_C,
        sets.data_S_01_23_SIMS_S_01_23_DataRepConPMTCT_Q2_PERC_SIMS_S_01_23_DataRepConPMTCT_Q2_D,
        sets.data_S_01_24_SIMS_S_01_24_DataRepConVMMC_Q2_PERC_generated_table_list_label_76,
        sets.data_S_01_24_SIMS_S_01_24_DataRepConVMMC_Q2_PERC_SIMS_S_01_24_DataRepConVMMC_Q2_A,
        sets.data_S_01_24_SIMS_S_01_24_DataRepConVMMC_Q2_PERC_SIMS_S_01_24_DataRepConVMMC_Q2_B,
        sets.data_S_01_24_SIMS_S_01_24_DataRepConVMMC_Q2_PERC_SIMS_S_01_24_DataRepConVMMC_Q2_C,
        sets.data_S_01_24_SIMS_S_01_24_DataRepConVMMC_Q2_PERC_SIMS_S_01_24_DataRepConVMMC_Q2_D,
        sets.Facility,
        sets.meta_details,
        sets.data_S_01_19_SIMS_S_01_19_DQA_Activities_SCORE_grade,
        sets.data_S_01_20_SIMS_S_01_20_PerfData_SCORE_grade,
        sets.data_S_01_21_SIMS_S_01_21_DataRepConTX_SCORE_grade,
        sets.data_S_01_22_SIMS_S_01_22_DataRepConHTS_SCORE_grade,
        sets.data_S_01_23_SIMS_S_01_23_DataRepConPMTCT_SCORE_grade,
        sets.data_S_01_24_SIMS_S_01_24_DataRepConVMMC_SCORE_grade,
        sets.Set_Average,
        sets.Expected_Average,
        sets.Average_Score,
        sets.Set_ID,
        hubs.Hub
        FROM `{PROJECT_ID}.{STAGING_DATASET}.S_1Ctest` as sets
        LEFT JOIN `{PROJECT_ID}.MFL.hub_details` as hubs
        ON cast(sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_FACILITY_MFL as int64) = hubs.MFL_Code
        ''',
        destination_dataset_table = f'{PROJECT_ID}:{STAGING_DATASET}.S_1Ctest',
        write_disposition='WRITE_TRUNCATE',
        allow_large_results=True,
        use_legacy_sql=False,
        dag=dag
    )

    t4 = BigQueryOperator(
        task_id='S2A_hubs',
        sql=f'''
        SELECT
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASSR_NAME,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_COUNTY,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_SUB_COUNTY,	
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_FACILITY,	
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_FACILITY_MFL,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_TYPE,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_DATE,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_START_TIME,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_END_TIME,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_LOCATION,
        sets.data_S_02_01_SIMS_S_02_01_Retst_Verif_STANDARD,
        sets.data_S_02_01_SIMS_S_02_01_Retst_Verif_INSTRUCTIONS,	
        sets.data_S_02_01_SIMS_S_02_01_Retst_Verif_Q1_RESP,
        sets.data_S_02_01_SIMS_S_02_01_Retst_Verif_Q2_RESP,	
        sets.data_S_02_01_SIMS_S_02_01_Retst_Verif_Q3_PERC_GRP_generated_table_list_label_19,
        sets.data_S_02_01_SIMS_S_02_01_Retst_Verif_Q3_PERC_GRP_SIMS_S_02_01_Retst_Verif_Q3_PERC,	
        sets.data_S_02_01_SIMS_S_02_01_Retst_Verif_Q3_PERC_GRP_SIMS_S_02_01_Retst_Verif_Q3_NUM,	
        sets.data_S_02_01_SIMS_S_02_01_Retst_Verif_Q3_PERC_GRP_SIMS_S_02_01_Retst_Verif_Q3_DEN,	
        sets.data_S_02_01_SIMS_S_02_01_Retst_Verif_COMM,
        sets.data_S_02_01_SIMS_S_02_01_Retst_Verif_SCORE,	
        sets.data_S_02_02_SIMS_S_02_02_PtTrkART_STANDARD,
        sets.data_S_02_02_SIMS_S_02_02_PtTrkART_Q1_RESP,	
        sets.data_S_02_02_SIMS_S_02_02_PtTrkART_Q2_PERC_GRP_generated_table_list_label_30,	
        sets.data_S_02_02_SIMS_S_02_02_PtTrkART_Q2_PERC_GRP_SIMS_S_02_02_PtTrkART_Q2_PERC,	
        sets.data_S_02_02_SIMS_S_02_02_PtTrkART_Q2_PERC_GRP_SIMS_S_02_02_PtTrkART_Q2_NUM,	
        sets.data_S_02_02_SIMS_S_02_02_PtTrkART_Q2_PERC_GRP_SIMS_S_02_02_PtTrkART_Q2_DEN,	
        sets.data_S_02_02_SIMS_S_02_02_PtTrkART_Q3_PERC_GRP_generated_table_list_label_35,	
        sets.data_S_02_02_SIMS_S_02_02_PtTrkART_Q3_PERC_GRP_SIMS_S_02_02_PtTrkART_Q3_PERC,
        sets.data_S_02_02_SIMS_S_02_02_PtTrkART_Q3_PERC_GRP_SIMS_S_02_02_PtTrkART_Q3_NUM,
        sets.data_S_02_02_SIMS_S_02_02_PtTrkART_Q3_PERC_GRP_SIMS_S_02_02_PtTrkART_Q3_DEN,	
        sets.data_S_02_02_SIMS_S_02_02_PtTrkART_COMM,
        sets.data_S_02_02_SIMS_S_02_02_PtTrkART_SCORE,
        sets.data_S_02_03_SIMS_S_02_03_RapidART_STANDARD,
        sets.data_S_02_03_SIMS_S_02_03_RapidART_INSTRUCTIONS,
        sets.data_S_02_03_SIMS_S_02_03_RapidART_NA,
        sets.data_S_02_03_SIMS_S_02_03_RapidART_Q1_RESP,
        sets.data_S_02_03_SIMS_S_02_03_RapidART_Q2_PERC_GRP_generated_table_list_label_48,
        sets.data_S_02_03_SIMS_S_02_03_RapidART_Q2_PERC_GRP_SIMS_S_02_03_RapidART_Q2_PERC,
        sets.data_S_02_03_SIMS_S_02_03_RapidART_Q2_PERC_GRP_SIMS_S_02_03_RapidART_Q2_NUM,	
        sets.data_S_02_03_SIMS_S_02_03_RapidART_Q2_PERC_GRP_SIMS_S_02_03_RapidART_Q2_DEN,	
        sets.data_S_02_03_SIMS_S_02_03_RapidART_COMM,
        sets.data_S_02_03_SIMS_S_02_03_RapidART_SCORE,
        sets.data_S_02_04_SIMS_S_02_04_VLMon_STANDARD,
        sets.data_S_02_04_SIMS_S_02_04_VLMon_Q1_RESP,	
        sets.data_S_02_04_SIMS_S_02_04_VLMon_Q2_PERC_GRP_generated_table_list_label_59,	
        sets.data_S_02_04_SIMS_S_02_04_VLMon_Q2_PERC_GRP_SIMS_S_02_04_VLMon_Q2_PERC,	
        sets.data_S_02_04_SIMS_S_02_04_VLMon_Q2_PERC_GRP_SIMS_S_02_04_VLMon_Q2_NUM,
        sets.data_S_02_04_SIMS_S_02_04_VLMon_Q2_PERC_GRP_SIMS_S_02_04_VLMon_Q2_DEN,
        sets.data_S_02_04_SIMS_S_02_04_VLMon_Q3_PERC_GRP_generated_table_list_label_64,	
        sets.data_S_02_04_SIMS_S_02_04_VLMon_Q3_PERC_GRP_SIMS_S_02_04_VLMon_Q3_PERC,	
        sets.data_S_02_04_SIMS_S_02_04_VLMon_Q3_PERC_GRP_SIMS_S_02_04_VLMon_Q3_NUM,	
        sets.data_S_02_04_SIMS_S_02_04_VLMon_Q3_PERC_GRP_SIMS_S_02_04_VLMon_Q3_DEN,	
        sets.data_S_02_04_SIMS_S_02_04_VLMon_COMM,
        sets.data_S_02_04_SIMS_S_02_04_VLMon_SCORE,
        sets.data_S_02_05_SIMS_S_02_05_MgmtVL_STANDARD,
        sets.data_S_02_05_SIMS_S_02_05_MgmtVL_INSTRUCTIONS,
        sets.data_S_02_05_SIMS_S_02_05_MgmtVL_NA,
        sets.data_S_02_05_SIMS_S_02_05_MgmtVL_Q1_T_NUM,
        sets.data_S_02_05_SIMS_S_02_05_MgmtVL_Q2_PERC_GRP_generated_table_list_label_77,	
        sets.data_S_02_05_SIMS_S_02_05_MgmtVL_Q2_PERC_GRP_SIMS_S_02_05_MgmtVL_Q2_PERC,	
        sets.data_S_02_05_SIMS_S_02_05_MgmtVL_Q2_PERC_GRP_SIMS_S_02_05_MgmtVL_Q2_NUM,	
        sets.data_S_02_05_SIMS_S_02_05_MgmtVL_Q2_PERC_GRP_SIMS_S_02_05_MgmtVL_Q2_DEN,	
        sets.data_S_02_05_SIMS_S_02_05_MgmtVL_Q3_PERC_GRP_generated_table_list_label_82,	
        sets.data_S_02_05_SIMS_S_02_05_MgmtVL_Q3_PERC_GRP_SIMS_S_02_05_MgmtVL_Q3_PERC,	
        sets.data_S_02_05_SIMS_S_02_05_MgmtVL_Q3_PERC_GRP_SIMS_S_02_05_MgmtVL_Q3_NUM,	
        sets.data_S_02_05_SIMS_S_02_05_MgmtVL_Q3_PERC_GRP_SIMS_S_02_05_MgmtVL_Q3_DEN,	
        sets.data_S_02_05_SIMS_S_02_05_MgmtVL_COMM,
        sets.data_S_02_05_SIMS_S_02_05_MgmtVL_SCORE,
        sets.data_S_02_06_SIMS_S_02_06_ApptSpaceMMDrg_TAS_and_DIFFCARE_STANDARD,	
        sets.data_S_02_06_SIMS_S_02_06_ApptSpaceMMDrg_TAS_and_DIFFCARE_INSTRUCTIONS,	
        sets.data_S_02_06_SIMS_S_02_06_ApptSpaceMMDrg_TAS_and_DIFFCARE_NA,	
        sets.data_S_02_06_SIMS_S_02_06_ApptSpaceMMDrg_TAS_and_DIFFCARE_Q1_RESP,	
        sets.data_S_02_06_SIMS_S_02_06_ApptSpaceMMDrg_TAS_and_DIFFCARE_Q2_T_NUM,	
        sets.data_S_02_06_SIMS_S_02_06_ApptSpaceMMDrg_TAS_and_DIFFCARE_COMM,	
        sets.data_S_02_06_SIMS_S_02_06_ApptSpaceMMDrg_TAS_and_DIFFCARE_SCORE,	
        sets.data_S_02_07_SIMS_S_02_07_PartnServ_STANDARD,	
        sets.data_S_02_07_SIMS_S_02_07_PartnServ_Q1_RESP,
        sets.data_S_02_07_SIMS_S_02_07_PartnServ_Q2_RESP,
        sets.data_S_02_07_SIMS_S_02_07_PartnServ_Q3_PERC_GRP_generated_table_list_label_103,	
        sets.data_S_02_07_SIMS_S_02_07_PartnServ_Q3_PERC_GRP_SIMS_S_02_07_PartnServ_Q3_PERC,	
        sets.data_S_02_07_SIMS_S_02_07_PartnServ_Q3_PERC_GRP_SIMS_S_02_07_PartnServ_Q3_NUM,	
        sets.data_S_02_07_SIMS_S_02_07_PartnServ_Q3_PERC_GRP_SIMS_S_02_07_PartnServ_Q3_DEN,	
        sets.data_S_02_07_SIMS_S_02_07_PartnServ_COMM,
        sets.data_S_02_07_SIMS_S_02_07_PartnServ_SCORE,
        sets.data_S_02_08_SIMS_S_02_08_ChildTest_STANDARD,
        sets.data_S_02_08_SIMS_S_02_08_ChildTest_Q1_RESP,	
        sets.data_S_02_08_SIMS_S_02_08_ChildTest_Q2_PERC_GRP_generated_table_list_label_114,	
        sets.data_S_02_08_SIMS_S_02_08_ChildTest_Q2_PERC_GRP_SIMS_S_02_08_ChildTest_Q2_PERC,	
        sets.data_S_02_08_SIMS_S_02_08_ChildTest_Q2_PERC_GRP_SIMS_S_02_08_ChildTest_Q2_NUM,
        sets.data_S_02_08_SIMS_S_02_08_ChildTest_Q2_PERC_GRP_SIMS_S_02_08_ChildTest_Q2_DEN,
        sets.data_S_02_08_SIMS_S_02_08_ChildTest_COMM,
        sets.data_S_02_08_SIMS_S_02_08_ChildTest_SCORE,	
        sets.data_S_02_09_SIMS_S_02_09_TBScreen_STANDARD,
        sets.data_S_02_09_SIMS_S_02_09_TBScreen_Q1_RESP,	
        sets.data_S_02_09_SIMS_S_02_09_TBScreen_Q2_PERC_GRP_generated_table_list_label_125,	
        sets.data_S_02_09_SIMS_S_02_09_TBScreen_Q2_PERC_GRP_SIMS_S_02_09_TBScreen_Q2_PERC,	
        sets.data_S_02_09_SIMS_S_02_09_TBScreen_Q2_PERC_GRP_SIMS_S_02_09_TBScreen_Q2_NUM,	
        sets.data_S_02_09_SIMS_S_02_09_TBScreen_Q2_PERC_GRP_SIMS_S_02_09_TBScreen_Q2_DEN,	
        sets.data_S_02_09_SIMS_S_02_09_TBScreen_COMM,	
        sets.data_S_02_09_SIMS_S_02_09_TBScreen_SCORE,
        sets.data_S_02_10_SIMS_S_02_10_IPT_STANDARD,	
        sets.data_S_02_10_SIMS_S_02_10_IPT_Q1_RESP,
        sets.data_S_02_10_SIMS_S_02_10_IPT_Q2_RESP,	
        sets.data_S_02_10_SIMS_S_02_10_IPT_Q3_PERC_GRP_generated_table_list_label_137,	
        sets.data_S_02_10_SIMS_S_02_10_IPT_Q3_PERC_GRP_SIMS_S_02_10_IPT_Q3_PERC,	
        sets.data_S_02_10_SIMS_S_02_10_IPT_Q3_PERC_GRP_SIMS_S_02_10_IPT_Q3_NUM,	
        sets.data_S_02_10_SIMS_S_02_10_IPT_Q3_PERC_GRP_SIMS_S_02_10_IPT_Q3_DEN,
        sets.data_S_02_10_SIMS_S_02_10_IPT_COMM,
        sets.data_S_02_10_SIMS_S_02_10_IPT_SCORE,
        sets.data_S_02_11_SIMS_S_02_11_CTXAdult_STANDARD,
        sets.data_S_02_11_SIMS_S_02_11_CTXAdult_INSTRUCTIONS,
        sets.data_S_02_11_SIMS_S_02_11_CTXAdult_NA,	
        sets.data_S_02_11_SIMS_S_02_11_CTXAdult_Q1_PERC_GRP_generated_table_list_label_149,	
        sets.data_S_02_11_SIMS_S_02_11_CTXAdult_Q1_PERC_GRP_SIMS_S_02_11_CTXAdult_Q1_PERC,	
        sets.data_S_02_11_SIMS_S_02_11_CTXAdult_Q1_PERC_GRP_SIMS_S_02_11_CTXAdult_Q1_NUM,	
        sets.data_S_02_11_SIMS_S_02_11_CTXAdult_Q1_PERC_GRP_SIMS_S_02_11_CTXAdult_Q1_DEN,	
        sets.data_S_02_11_SIMS_S_02_11_CTXAdult_COMM,
        sets.data_S_02_11_SIMS_S_02_11_CTXAdult_SCORE,
        sets.data_S_02_12_SIMS_S_02_12_TBDxEval_STANDARD,
        sets.data_S_02_12_SIMS_S_02_12_TBDxEval_INSTRUCTIONS,
        sets.data_S_02_12_SIMS_S_02_12_TBDxEval_NA,
        sets.data_S_02_12_SIMS_S_02_12_TBDxEval_Q1_RESP,
        sets.data_S_02_12_SIMS_S_02_12_TBDxEval_Q2_RESP,
        sets.data_S_02_12_SIMS_S_02_12_TBDxEval_Q3_PERC_GRP_generated_table_list_label_163,
        sets.data_S_02_12_SIMS_S_02_12_TBDxEval_Q3_PERC_GRP_SIMS_S_02_12_TBDxEval_Q3_PERC,
        sets.data_S_02_12_SIMS_S_02_12_TBDxEval_Q3_PERC_GRP_SIMS_S_02_12_TBDxEval_Q3_NUM,
        sets.data_S_02_12_SIMS_S_02_12_TBDxEval_Q3_PERC_GRP_SIMS_S_02_12_TBDxEval_Q3_DEN,
        sets.data_S_02_12_SIMS_S_02_12_TBDxEval_Q4_PERC_GRP_generated_table_list_label_168,	
        sets.data_S_02_12_SIMS_S_02_12_TBDxEval_Q4_PERC_GRP_SIMS_S_02_12_TBDxEval_Q4_PERC,	
        sets.data_S_02_12_SIMS_S_02_12_TBDxEval_Q4_PERC_GRP_SIMS_S_02_12_TBDxEval_Q4_NUM,
        sets.data_S_02_12_SIMS_S_02_12_TBDxEval_Q4_PERC_GRP_SIMS_S_02_12_TBDxEval_Q4_DEN,	
        sets.data_S_02_12_SIMS_S_02_12_TBDxEval_COMM,
        sets.data_S_02_12_SIMS_S_02_12_TBDxEval_SCORE,
        sets.data_S_02_13_SIMS_S_02_13_CommLinkRetSuppServ_STANDARD,
        sets.data_S_02_13_SIMS_S_02_13_CommLinkRetSuppServ_Q1_T_NUM,
        sets.data_S_02_13_SIMS_S_02_13_CommLinkRetSuppServ_Q2_T_NUM,
        sets.data_S_02_13_SIMS_S_02_13_CommLinkRetSuppServ_COMM,
        sets.data_S_02_13_SIMS_S_02_13_CommLinkRetSuppServ_SCORE,
        sets.data_S_02_14_SIMS_S_02_14_SrvcRefLinkSyst_STANDARD,
        sets.data_S_02_14_SIMS_S_02_14_SrvcRefLinkSyst_Q1_T_NUM,
        sets.data_S_02_14_SIMS_S_02_14_SrvcRefLinkSyst_Q2_PERC_GRP_generated_table_list_label_186,
        sets.data_S_02_14_SIMS_S_02_14_SrvcRefLinkSyst_Q2_PERC_GRP_SIMS_S_02_14_SrvcRefLinkSyst_Q2_PERC,
        sets.data_S_02_14_SIMS_S_02_14_SrvcRefLinkSyst_Q2_PERC_GRP_SIMS_S_02_14_SrvcRefLinkSyst_Q2_NUM,
        sets.data_S_02_14_SIMS_S_02_14_SrvcRefLinkSyst_Q2_PERC_GRP_SIMS_S_02_14_SrvcRefLinkSyst_Q2_DEN,
        sets.data_S_02_14_SIMS_S_02_14_SrvcRefLinkSyst_COMM,
        sets.data_S_02_14_SIMS_S_02_14_SrvcRefLinkSyst_SCORE,
        sets.data_S_02_15_SIMS_S_02_15_FPInteg_STANDARD,
        sets.data_S_02_15_SIMS_S_02_15_FPInteg_Q1_RESP,
        sets.data_S_02_15_SIMS_S_02_15_FPInteg_Q2_RESP,
        sets.data_S_02_15_SIMS_S_02_15_FPInteg_Q3_RESP,
        sets.data_S_02_15_SIMS_S_02_15_FPInteg_Q4_RESP,
        sets.data_S_02_15_SIMS_S_02_15_FPInteg_Q5_RESP,
        sets.data_S_02_15_SIMS_S_02_15_FPInteg_COMM,
        sets.data_S_02_15_SIMS_S_02_15_FPInteg_SCORE,
        sets.data_S_02_16_SIMS_S_02_16_FP_HIV_IntegrservDel_STANDARD,	
        sets.data_S_02_16_SIMS_S_02_16_FP_HIV_IntegrservDel_INSTRUCTIONS,
        sets.data_S_02_16_SIMS_S_02_16_FP_HIV_IntegrservDel_NA,
        sets.data_S_02_16_SIMS_S_02_16_FP_HIV_IntegrservDel_Q1_RESP,
        sets.data_S_02_16_SIMS_S_02_16_FP_HIV_IntegrservDel_Q2_RESP,
        sets.data_S_02_16_SIMS_S_02_16_FP_HIV_IntegrservDel_Q3_RESP,
        sets.data_S_02_16_SIMS_S_02_16_FP_HIV_IntegrservDel_Q4_RESP,
        sets.data_S_02_16_SIMS_S_02_16_FP_HIV_IntegrservDel_COMM,
        sets.data_S_02_16_SIMS_S_02_16_FP_HIV_IntegrservDel_SCORE,
        sets.data_S_02_17_SIMS_S_02_17_CervCancScreen_STANDARD,
        sets.data_S_02_17_SIMS_S_02_17_CervCancScreen_INSTRUCTIONS,
        sets.data_S_02_17_SIMS_S_02_17_CervCancScreen_NA,
        sets.data_S_02_17_SIMS_S_02_17_CervCancScreen_Q1_T_NUM,
        sets.data_S_02_17_SIMS_S_02_17_CervCancScreen_Q2_T_NUM,
        sets.data_S_02_17_SIMS_S_02_17_CervCancScreen_Q3_PERC_GRP_generated_table_list_label_221,	
        sets.data_S_02_17_SIMS_S_02_17_CervCancScreen_Q3_PERC_GRP_SIMS_S_02_17_CervCancScreen_Q3_PERC,
        sets.data_S_02_17_SIMS_S_02_17_CervCancScreen_Q3_PERC_GRP_SIMS_S_02_17_CervCancScreen_Q3_NUM,
        sets.data_S_02_17_SIMS_S_02_17_CervCancScreen_Q3_PERC_GRP_SIMS_S_02_17_CervCancScreen_Q3_DEN,
        sets.data_S_02_17_SIMS_S_02_17_CervCancScreen_COMM,
        sets.data_S_02_17_SIMS_S_02_17_CervCancScreen_SCORE,	
        sets.data_meta_instanceID,
        sets.data_meta_instanceName,
        sets.Facility,
        sets.meta_details,
        sets.data_S_02_01_SIMS_S_02_01_Retst_Verif_SCORE_grade,
        sets.data_S_02_02_SIMS_S_02_02_PtTrkART_SCORE_grade,
        sets.data_S_02_03_SIMS_S_02_03_RapidART_SCORE_grade,
        sets.data_S_02_04_SIMS_S_02_04_VLMon_SCORE_grade,
        sets.data_S_02_05_SIMS_S_02_05_MgmtVL_SCORE_grade,
        sets.data_S_02_06_SIMS_S_02_06_ApptSpaceMMDrg_TAS_and_DIFFCARE_SCORE_grade,
        sets.data_S_02_07_SIMS_S_02_07_PartnServ_SCORE_grade,
        sets.data_S_02_08_SIMS_S_02_08_ChildTest_SCORE_grade,
        sets.data_S_02_09_SIMS_S_02_09_TBScreen_SCORE_grade,
        sets.data_S_02_10_SIMS_S_02_10_IPT_SCORE_grade,
        sets.data_S_02_11_SIMS_S_02_11_CTXAdult_SCORE_grade,
        sets.data_S_02_12_SIMS_S_02_12_TBDxEval_SCORE_grade,
        sets.data_S_02_13_SIMS_S_02_13_CommLinkRetSuppServ_SCORE_grade,	
        sets.data_S_02_14_SIMS_S_02_14_SrvcRefLinkSyst_SCORE_grade,
        sets.data_S_02_15_SIMS_S_02_15_FPInteg_SCORE_grade,
        sets.data_S_02_16_SIMS_S_02_16_FP_HIV_IntegrservDel_SCORE_grade,
        sets.data_S_02_17_SIMS_S_02_17_CervCancScreen_SCORE_grade,
        sets.Set_Average,
        sets.Expected_Average,
        sets.Average_Score,
        sets.Set_ID,
        hubs.Hub
        FROM `{PROJECT_ID}.{STAGING_DATASET}.S_2Atest` as sets
        LEFT JOIN `{PROJECT_ID}.MFL.hub_details` as hubs
        ON cast(sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_FACILITY_MFL as int64) = hubs.MFL_Code
        ''',
        destination_dataset_table = f'{PROJECT_ID}:{STAGING_DATASET}.S_2Atest',
        write_disposition='WRITE_TRUNCATE',
        allow_large_results=True,
        use_legacy_sql=False,
        dag=dag
    )

    t5 = BigQueryOperator(
        task_id='S2B_hubs',
        sql=f'''
        SELECT
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASSR_NAME,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_COUNTY,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_SUB_COUNTY,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_FACILITY,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_FACILITY_MFL,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_TYPE,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_DATE,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_START_TIME,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_END_TIME,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_LOCATION,
        sets.data_S_02_18_SIMS_S_02_18_Retst_Verif_Peds_STANDARD,
        sets.data_S_02_18_SIMS_S_02_18_Retst_Verif_Peds_INSTRUCTIONS,
        sets.data_S_02_18_SIMS_S_02_18_Retst_Verif_Peds_Q1_RESP,
        sets.data_S_02_18_SIMS_S_02_18_Retst_Verif_Peds_Q2_RESP,
        sets.data_S_02_18_SIMS_S_02_18_Retst_Verif_Peds_Q3_PERC_GRP_generated_table_list_label_19,
        sets.data_S_02_18_SIMS_S_02_18_Retst_Verif_Peds_Q3_PERC_GRP_SIMS_S_02_18_Retst_Verif_Peds_Q3_PERC,
        sets.data_S_02_18_SIMS_S_02_18_Retst_Verif_Peds_Q3_PERC_GRP_SIMS_S_02_18_Retst_Verif_Peds_Q3_NUM,
        sets.data_S_02_18_SIMS_S_02_18_Retst_Verif_Peds_Q3_PERC_GRP_SIMS_S_02_18_Retst_Verif_Peds_Q3_DEN,
        sets.data_S_02_18_SIMS_S_02_18_Retst_Verif_Peds_COMM,
        sets.data_S_02_18_SIMS_S_02_18_Retst_Verif_Peds_SCORE,
        sets.data_S_02_19_SIMS_S_02_19_PtTrkART_Peds_STANDARD,
        sets.data_S_02_19_SIMS_S_02_19_PtTrkART_Peds_Q1_RESP,
        sets.data_S_02_19_SIMS_S_02_19_PtTrkART_Peds_Q2_PERC_GRP_generated_table_list_label_30,
        sets.data_S_02_19_SIMS_S_02_19_PtTrkART_Peds_Q2_PERC_GRP_SIMS_S_02_19_PtTrkART_Peds_Q2_PERC,
        sets.data_S_02_19_SIMS_S_02_19_PtTrkART_Peds_Q2_PERC_GRP_SIMS_S_02_19_PtTrkART_Peds_Q2_NUM,
        sets.data_S_02_19_SIMS_S_02_19_PtTrkART_Peds_Q2_PERC_GRP_SIMS_S_02_19_PtTrkART_Peds_Q2_DEN,
        sets.data_S_02_19_SIMS_S_02_19_PtTrkART_Peds_Q3_PERC_GRP_generated_table_list_label_35,
        sets.data_S_02_19_SIMS_S_02_19_PtTrkART_Peds_Q3_PERC_GRP_SIMS_S_02_19_PtTrkART_Peds_Q3_PERC,
        sets.data_S_02_19_SIMS_S_02_19_PtTrkART_Peds_Q3_PERC_GRP_SIMS_S_02_19_PtTrkART_Peds_Q3_NUM,
        sets.data_S_02_19_SIMS_S_02_19_PtTrkART_Peds_Q3_PERC_GRP_SIMS_S_02_19_PtTrkART_Peds_Q3_DEN,
        sets.data_S_02_19_SIMS_S_02_19_PtTrkART_Peds_COMM,
        sets.data_S_02_19_SIMS_S_02_19_PtTrkART_Peds_SCORE,
        sets.data_S_02_20_SIMS_S_02_20_FirstLineART_STANDARD,
        sets.data_S_02_20_SIMS_S_02_20_FirstLineART_Q1_RESP,
        sets.data_S_02_20_SIMS_S_02_20_FirstLineART_Q2_T_NUM,
        sets.data_S_02_20_SIMS_S_02_20_FirstLineART_COMM,
        sets.data_S_02_20_SIMS_S_02_20_FirstLineART_SCORE,
        sets.data_S_02_21_SIMS_S_02_21_ARVDosePeds_STANDARD,
        sets.data_S_02_21_SIMS_S_02_21_ARVDosePeds_Q1_RESP,
        sets.data_S_02_21_SIMS_S_02_21_ARVDosePeds_Q2_RESP,
        sets.data_S_02_21_SIMS_S_02_21_ARVDosePeds_COMM,
        sets.data_S_02_21_SIMS_S_02_21_ARVDosePeds_SCORE,
        sets.data_S_02_22_SIMS_S_02_22_VLMonPeds_STANDARD,
        sets.data_S_02_22_SIMS_S_02_22_VLMonPeds_Q1_RESP,
        sets.data_S_02_22_SIMS_S_02_22_VLMonPeds_Q2_PERC_GRP_generated_table_list_label_60,
        sets.data_S_02_22_SIMS_S_02_22_VLMonPeds_Q2_PERC_GRP_SIMS_S_02_22_VLMonPeds_Q2_PERC,
        sets.data_S_02_22_SIMS_S_02_22_VLMonPeds_Q2_PERC_GRP_SIMS_S_02_22_VLMonPeds_Q2_NUM,
        sets.data_S_02_22_SIMS_S_02_22_VLMonPeds_Q2_PERC_GRP_SIMS_S_02_22_VLMonPeds_Q2_DEN,
        sets.data_S_02_22_SIMS_S_02_22_VLMonPeds_Q3_PERC_GRP_generated_table_list_label_65,
        sets.data_S_02_22_SIMS_S_02_22_VLMonPeds_Q3_PERC_GRP_SIMS_S_02_22_VLMonPeds_Q3_PERC,
        sets.data_S_02_22_SIMS_S_02_22_VLMonPeds_Q3_PERC_GRP_SIMS_S_02_22_VLMonPeds_Q3_NUM,
        sets.data_S_02_22_SIMS_S_02_22_VLMonPeds_Q3_PERC_GRP_SIMS_S_02_22_VLMonPeds_Q3_DEN,
        sets.data_S_02_22_SIMS_S_02_22_VLMonPeds_COMM,
        sets.data_S_02_22_SIMS_S_02_22_VLMonPeds_SCORE,
        sets.data_S_02_23_SIMS_S_02_23_MgmtVLPeds_STANDARD,
        sets.data_S_02_23_SIMS_S_02_23_MgmtVLPeds_INSTRUCTIONS,
        sets.data_S_02_23_SIMS_S_02_23_MgmtVLPeds_NA,
        sets.data_S_02_23_SIMS_S_02_23_MgmtVLPeds_Q1_T_NUM,
        sets.data_S_02_23_SIMS_S_02_23_MgmtVLPeds_Q2_PERC_GRP_generated_table_list_label_78,
        sets.data_S_02_23_SIMS_S_02_23_MgmtVLPeds_Q2_PERC_GRP_SIMS_S_02_23_MgmtVLPeds_Q2_PERC,
        sets.data_S_02_23_SIMS_S_02_23_MgmtVLPeds_Q2_PERC_GRP_SIMS_S_02_23_MgmtVLPeds_Q2_NUM,
        sets.data_S_02_23_SIMS_S_02_23_MgmtVLPeds_Q2_PERC_GRP_SIMS_S_02_23_MgmtVLPeds_Q2_DEN,
        sets.data_S_02_23_SIMS_S_02_23_MgmtVLPeds_Q3_PERC_GRP_generated_table_list_label_83,
        sets.data_S_02_23_SIMS_S_02_23_MgmtVLPeds_Q3_PERC_GRP_SIMS_S_02_23_MgmtVLPeds_Q3_PERC,
        sets.data_S_02_23_SIMS_S_02_23_MgmtVLPeds_Q3_PERC_GRP_SIMS_S_02_23_MgmtVLPeds_Q3_NUM,
        sets.data_S_02_23_SIMS_S_02_23_MgmtVLPeds_Q3_PERC_GRP_SIMS_S_02_23_MgmtVLPeds_Q3_DEN,
        sets.data_S_02_23_SIMS_S_02_23_MgmtVLPeds_COMM,
        sets.data_S_02_23_SIMS_S_02_23_MgmtVLPeds_SCORE,
        sets.data_S_02_24_SIMS_S_02_24_ApptSpaceMMDrg_TAS_and_DIFFCARE_Peds_STANDARD,
        sets.data_S_02_24_SIMS_S_02_24_ApptSpaceMMDrg_TAS_and_DIFFCARE_Peds_INSTRUCTIONS,
        sets.data_S_02_24_SIMS_S_02_24_ApptSpaceMMDrg_TAS_and_DIFFCARE_Peds_NA,
        sets.data_S_02_24_SIMS_S_02_24_ApptSpaceMMDrg_TAS_and_DIFFCARE_Peds_Q1_RESP,
        sets.data_S_02_24_SIMS_S_02_24_ApptSpaceMMDrg_TAS_and_DIFFCARE_Peds_Q2_T_NUM,
        sets.data_S_02_24_SIMS_S_02_24_ApptSpaceMMDrg_TAS_and_DIFFCARE_Peds_COMM,
        sets.data_S_02_24_SIMS_S_02_24_ApptSpaceMMDrg_TAS_and_DIFFCARE_Peds_SCORE,
        sets.data_S_02_25_SIMS_S_02_25_PedsTest_STANDARD,
        sets.data_S_02_25_SIMS_S_02_25_PedsTest_INSTRUCTIONS,
        sets.data_S_02_25_SIMS_S_02_25_PedsTest_NA,
        sets.data_S_02_25_SIMS_S_02_25_PedsTest_Q1_T_NUM,
        sets.data_S_02_25_SIMS_S_02_25_PedsTest_Q2_RESP,
        sets.data_S_02_25_SIMS_S_02_25_PedsTest_Q3_PERC_GRP_generated_table_list_label_106,
        sets.data_S_02_25_SIMS_S_02_25_PedsTest_Q3_PERC_GRP_SIMS_S_02_25_PedsTest_Q3_PERC,
        sets.data_S_02_25_SIMS_S_02_25_PedsTest_Q3_PERC_GRP_SIMS_S_02_25_PedsTest_Q3_NUM,
        sets.data_S_02_25_SIMS_S_02_25_PedsTest_Q3_PERC_GRP_SIMS_S_02_25_PedsTest_Q3_DEN,
        sets.data_S_02_25_SIMS_S_02_25_PedsTest_COMM,
        sets.data_S_02_25_SIMS_S_02_25_PedsTest_SCORE,
        sets.data_S_02_26_SIMS_S_02_26_TBScrnPeds_STANDARD,
        sets.data_S_02_26_SIMS_S_02_26_TBScrnPeds_Q1_RESP,
        sets.data_S_02_26_SIMS_S_02_26_TBScrnPeds_Q2_PERC_GRP_generated_table_list_label_117,
        sets.data_S_02_26_SIMS_S_02_26_TBScrnPeds_Q2_PERC_GRP_SIMS_S_02_26_TBScrnPeds_Q2_PERC,
        sets.data_S_02_26_SIMS_S_02_26_TBScrnPeds_Q2_PERC_GRP_SIMS_S_02_26_TBScrnPeds_Q2_DEN,
        sets.data_S_02_26_SIMS_S_02_26_TBScrnPeds_Q2_PERC_GRP_SIMS_S_02_26_TBScrnPeds_Q2_NUM,
        sets.data_S_02_26_SIMS_S_02_26_TBScrnPeds_COMM,
        sets.data_S_02_26_SIMS_S_02_26_TBScrnPeds_SCORE,
        sets.data_S_02_27_SIMS_S_02_27_IPTPeds_STANDARD,
        sets.data_S_02_27_SIMS_S_02_27_IPTPeds_Q1_RESP,
        sets.data_S_02_27_SIMS_S_02_27_IPTPeds_Q2_RESP,
        sets.data_S_02_27_SIMS_S_02_27_IPTPeds_Q3_PERC_GRP_generated_table_list_label_129,
        sets.data_S_02_27_SIMS_S_02_27_IPTPeds_Q3_PERC_GRP_SIMS_S_02_27_IPTPeds_Q3_PERC,
        sets.data_S_02_27_SIMS_S_02_27_IPTPeds_Q3_PERC_GRP_SIMS_S_02_27_IPTPeds_Q3_NUM,
        sets.data_S_02_27_SIMS_S_02_27_IPTPeds_Q3_PERC_GRP_SIMS_S_02_27_IPTPeds_Q3_DEN,
        sets.data_S_02_27_SIMS_S_02_27_IPTPeds_COMM,
        sets.data_S_02_27_SIMS_S_02_27_IPTPeds_SCORE,
        sets.data_S_02_28_SIMS_S_02_28_CTXPeds_STANDARD,
        sets.data_S_02_28_SIMS_S_02_28_CTXPeds_INSTRUCTIONS,
        sets.data_S_02_28_SIMS_S_02_28_CTXPeds_NA,
        sets.data_S_02_28_SIMS_S_02_28_CTXPeds_Q1_PERC_GRP_generated_table_list_label_141,
        sets.data_S_02_28_SIMS_S_02_28_CTXPeds_Q1_PERC_GRP_SIMS_S_02_28_CTXPeds_Q1_PERC,
        sets.data_S_02_28_SIMS_S_02_28_CTXPeds_Q1_PERC_GRP_SIMS_S_02_28_CTXPeds_Q1_NUM,
        sets.data_S_02_28_SIMS_S_02_28_CTXPeds_Q1_PERC_GRP_SIMS_S_02_28_CTXPeds_Q1_DEN,
        sets.data_S_02_28_SIMS_S_02_28_CTXPeds_COMM,
        sets.data_S_02_28_SIMS_S_02_28_CTXPeds_SCORE,
        sets.data_S_02_29_SIMS_S_02_29_TBDxEvalPeds_STANDARD,
        sets.data_S_02_29_SIMS_S_02_29_TBDxEvalPeds_INSTRUCTIONS,
        sets.data_S_02_29_SIMS_S_02_29_TBDxEvalPeds_NA,
        sets.data_S_02_29_SIMS_S_02_29_TBDxEvalPeds_Q1_RESP,
        sets.data_S_02_29_SIMS_S_02_29_TBDxEvalPeds_Q2_RESP,
        sets.data_S_02_29_SIMS_S_02_29_TBDxEvalPeds_Q3_PERC_GRP_generated_table_list_label_155,
        sets.data_S_02_29_SIMS_S_02_29_TBDxEvalPeds_Q3_PERC_GRP_SIMS_S_02_29_TBDxEvalPeds_Q3_PERC,
        sets.data_S_02_29_SIMS_S_02_29_TBDxEvalPeds_Q3_PERC_GRP_SIMS_S_02_29_TBDxEvalPeds_Q3_NUM,
        sets.data_S_02_29_SIMS_S_02_29_TBDxEvalPeds_Q3_PERC_GRP_SIMS_S_02_29_TBDxEvalPeds_Q3_DEN,
        sets.data_S_02_29_SIMS_S_02_29_TBDxEvalPeds_COMM,
        sets.data_S_02_29_SIMS_S_02_29_TBDxEvalPeds_SCORE,
        sets.data_S_02_30_SIMS_S_02_30_AdolServs_STANDARD,
        sets.data_S_02_30_SIMS_S_02_30_AdolServs_Q1_T_NUM,
        sets.data_S_02_30_SIMS_S_02_30_AdolServs_Q2_T_NUM,
        sets.data_S_02_30_SIMS_S_02_30_AdolServs_COMM,
        sets.data_S_02_30_SIMS_S_02_30_AdolServs_SCORE,
        sets.data_S_02_31_SIMS_S_02_31_CommLinkRetSuppServ_Peds_STANDARD,
        sets.data_S_02_31_SIMS_S_02_31_CommLinkRetSuppServ_Peds_Q1_T_NUM,
        sets.data_S_02_31_SIMS_S_02_31_CommLinkRetSuppServ_Peds_Q2_T_NUM,
        sets.data_S_02_31_SIMS_S_02_31_CommLinkRetSuppServ_Peds_COMM,
        sets.data_S_02_31_SIMS_S_02_31_CommLinkRetSuppServ_Peds_SCORE,
        sets.data_S_02_32_SIMS_S_02_32_SrvcRefLinkSyst_Peds_STANDARD,
        sets.data_S_02_32_SIMS_S_02_32_SrvcRefLinkSyst_Peds_Q1_T_NUM,
        sets.data_S_02_32_SIMS_S_02_32_SrvcRefLinkSyst_Peds_Q2_PERC_GRP_generated_table_list_label_180,
        sets.data_S_02_32_SIMS_S_02_32_SrvcRefLinkSyst_Peds_Q2_PERC_GRP_SIMS_S_02_32_SrvcRefLinkSyst_Peds_Q2_PERC,
        sets.data_S_02_32_SIMS_S_02_32_SrvcRefLinkSyst_Peds_Q2_PERC_GRP_SIMS_S_02_32_SrvcRefLinkSyst_Peds_Q2_NUM,
        sets.data_S_02_32_SIMS_S_02_32_SrvcRefLinkSyst_Peds_Q2_PERC_GRP_SIMS_S_02_32_SrvcRefLinkSyst_Peds_Q2_DEN,
        sets.data_S_02_32_SIMS_S_02_32_SrvcRefLinkSyst_Peds_COMM,
        sets.data_S_02_32_SIMS_S_02_32_SrvcRefLinkSyst_Peds_SCORE,
        sets.data_meta_instanceID,
        sets.data_meta_instanceName,
        sets.Facility,
        sets.meta_details,
        sets.data_S_02_18_SIMS_S_02_18_Retst_Verif_Peds_SCORE_grade,
        sets.data_S_02_19_SIMS_S_02_19_PtTrkART_Peds_SCORE_grade,
        sets.data_S_02_20_SIMS_S_02_20_FirstLineART_SCORE_grade,
        sets.data_S_02_21_SIMS_S_02_21_ARVDosePeds_SCORE_grade,
        sets.data_S_02_22_SIMS_S_02_22_VLMonPeds_SCORE_grade,
        sets.data_S_02_23_SIMS_S_02_23_MgmtVLPeds_SCORE_grade,
        sets.data_S_02_24_SIMS_S_02_24_ApptSpaceMMDrg_TAS_and_DIFFCARE_Peds_SCORE_grade,
        sets.data_S_02_25_SIMS_S_02_25_PedsTest_SCORE_grade,
        sets.data_S_02_26_SIMS_S_02_26_TBScrnPeds_SCORE_grade,
        sets.data_S_02_27_SIMS_S_02_27_IPTPeds_SCORE_grade,
        sets.data_S_02_28_SIMS_S_02_28_CTXPeds_SCORE_grade,
        sets.data_S_02_29_SIMS_S_02_29_TBDxEvalPeds_SCORE_grade,
        sets.data_S_02_30_SIMS_S_02_30_AdolServs_SCORE_grade,
        sets.data_S_02_31_SIMS_S_02_31_CommLinkRetSuppServ_Peds_SCORE_grade,
        sets.data_S_02_32_SIMS_S_02_32_SrvcRefLinkSyst_Peds_SCORE_grade,
        sets.Set_Average,
        sets.Expected_Average,
        sets.Average_Score,
        sets.Set_ID,
        hubs.Hub
        FROM `{PROJECT_ID}.{STAGING_DATASET}.S_2Btest` as sets
        LEFT JOIN `{PROJECT_ID}.MFL.hub_details` as hubs
        ON cast(sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_FACILITY_MFL as int64) = hubs.MFL_Code
        ''',
        destination_dataset_table = f'{PROJECT_ID}:{STAGING_DATASET}.S_2Btest',
        write_disposition='WRITE_TRUNCATE',
        allow_large_results=True,
        use_legacy_sql=False,
        dag=dag
    )

    t6 = BigQueryOperator(
        task_id='S3A_hubs',
        sql=f'''
        SELECT
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASSR_NAME,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_COUNTY,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_SUB_COUNTY,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_FACILITY,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_FACILITY_MFL,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_TYPE,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_DATE,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_START_TIME,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_END_TIME,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_LOCATION,
        sets.data_S_03_01_SIMS_S_03_01_Lube_KP_STANDARD,
        sets.data_S_03_01_SIMS_S_03_01_Lube_KP_Q1_T_NUM,
        sets.data_S_03_01_SIMS_S_03_01_Lube_KP_Q2_RESP,
        sets.data_S_03_01_SIMS_S_03_01_Lube_KP_COMM,
        sets.data_S_03_01_SIMS_S_03_01_Lube_KP_SCORE,
        sets.data_S_03_02_SIMS_S_03_02_STI_KP_STANDARD,
        sets.data_S_03_02_SIMS_S_03_02_STI_KP_INSTRUCTIONS,
        sets.data_S_03_02_SIMS_S_03_02_STI_KP_NA,
        sets.data_S_03_02_SIMS_S_03_02_STI_KP_Q1_RESP,
        sets.data_S_03_02_SIMS_S_03_02_STI_KP_Q2_RESP	,
        sets.data_S_03_02_SIMS_S_03_02_STI_KP_Q3_RESP,
        sets.data_S_03_02_SIMS_S_03_02_STI_KP_Q4_PERC_GRP_generated_table_list_label_28,
        sets.data_S_03_02_SIMS_S_03_02_STI_KP_Q4_PERC_GRP_SIMS_S_03_02_STI_KP_Q4_PERC,
        sets.data_S_03_02_SIMS_S_03_02_STI_KP_Q4_PERC_GRP_SIMS_S_03_02_STI_KP_Q4_NUM,
        sets.data_S_03_02_SIMS_S_03_02_STI_KP_Q4_PERC_GRP_SIMS_S_03_02_STI_KP_Q4_DEN,
        sets.data_S_03_02_SIMS_S_03_02_STI_KP_COMM,
        sets.data_S_03_02_SIMS_S_03_02_STI_KP_SCORE,
        sets.data_S_03_03_SIMS_S_03_03_PeerOutrchMgmt_STANDARD,
        sets.data_S_03_03_SIMS_S_03_03_PeerOutrchMgmt_INSTRUCTIONS,
        sets.data_S_03_03_SIMS_S_03_03_PeerOutrchMgmt_NA,
        sets.data_S_03_03_SIMS_S_03_03_PeerOutrchMgmt_Q1_RESP,
        sets.data_S_03_03_SIMS_S_03_03_PeerOutrchMgmt_Q2_RESP,
        sets.data_S_03_03_SIMS_S_03_03_PeerOutrchMgmt_Q3_RESP,
        sets.data_S_03_03_SIMS_S_03_03_PeerOutrchMgmt_Q4_RESP,
        sets.data_S_03_03_SIMS_S_03_03_PeerOutrchMgmt_COMM,
        sets.data_S_03_03_SIMS_S_03_03_PeerOutrchMgmt_SCORE,
        sets.data_S_03_04_SIMS_S_03_04_FP_HIV_IntegrservDel_KPGen_STANDARD,
        sets.data_S_03_04_SIMS_S_03_04_FP_HIV_IntegrservDel_KPGen_INSTRUCTIONS,
        sets.data_S_03_04_SIMS_S_03_04_FP_HIV_IntegrservDel_KPGen_NA,
        sets.data_S_03_04_SIMS_S_03_04_FP_HIV_IntegrservDel_KPGen_Q1_RESP,
        sets.data_S_03_04_SIMS_S_03_04_FP_HIV_IntegrservDel_KPGen_Q2_RESP,
        sets.data_S_03_04_SIMS_S_03_04_FP_HIV_IntegrservDel_KPGen_Q3_RESP,
        sets.data_S_03_04_SIMS_S_03_04_FP_HIV_IntegrservDel_KPGen_Q4_RESP,
        sets.data_S_03_04_SIMS_S_03_04_FP_HIV_IntegrservDel_KPGen_COMM,
        sets.data_S_03_04_SIMS_S_03_04_FP_HIV_IntegrservDel_KPGen_SCORE,
        sets.data_S_03_05_SIMS_S_03_05_KP_PrgmData_STANDARD,
        sets.data_S_03_05_SIMS_S_03_05_KP_PrgmData_INSTRUCTIONS,
        sets.data_S_03_05_SIMS_S_03_05_KP_PrgmData_NA,
        sets.data_S_03_05_SIMS_S_03_05_KP_PrgmData_Q1_RESP,
        sets.data_S_03_05_SIMS_S_03_05_KP_PrgmData_Q2_RESP,
        sets.data_S_03_05_SIMS_S_03_05_KP_PrgmData_Q3_RESP,
        sets.data_S_03_05_SIMS_S_03_05_KP_PrgmData_Q4_PERC_GRP_generated_table_list_label_65,
        sets.data_S_03_05_SIMS_S_03_05_KP_PrgmData_Q4_PERC_GRP_SIMS_S_03_05_KP_PrgmData_Q4_PERC,
        sets.data_S_03_05_SIMS_S_03_05_KP_PrgmData_Q4_PERC_GRP_SIMS_S_03_05_KP_PrgmData_Q4_NUM,
        sets.data_S_03_05_SIMS_S_03_05_KP_PrgmData_Q4_PERC_GRP_SIMS_S_03_05_KP_PrgmData_Q4_DEN,
        sets.data_S_03_05_SIMS_S_03_05_KP_PrgmData_COMM,
        sets.data_S_03_05_SIMS_S_03_05_KP_PrgmData_SCORE,
        sets.data_S_03_06_SIMS_S_03_06_ProvSensServ_KP_STANDARD,
        sets.data_S_03_06_SIMS_S_03_06_ProvSensServ_KP_Q1_RESP,
        sets.data_S_03_06_SIMS_S_03_06_ProvSensServ_KP_Q2_RESP,
        sets.data_S_03_06_SIMS_S_03_06_ProvSensServ_KP_Q3_T_NUM,
        sets.data_S_03_06_SIMS_S_03_06_ProvSensServ_KP_COMM,
        sets.data_S_03_06_SIMS_S_03_06_ProvSensServ_KP_SCORE,
        sets.data_S_03_07_SIMS_S_03_07_ProvPrEPServ_KP_STANDARD,
        sets.data_S_03_07_SIMS_S_03_07_ProvPrEPServ_KP_INSTRUCTIONS,
        sets.data_S_03_07_SIMS_S_03_07_ProvPrEPServ_KP_NA,
        sets.data_S_03_07_SIMS_S_03_07_ProvPrEPServ_KP_Q1_RESP,
        sets.data_S_03_07_SIMS_S_03_07_ProvPrEPServ_KP_Q2_RESP,
        sets.data_S_03_07_SIMS_S_03_07_ProvPrEPServ_KP_Q3_T_NUM,
        sets.data_S_03_07_SIMS_S_03_07_ProvPrEPServ_KP_COMM,
        sets.data_S_03_07_SIMS_S_03_07_ProvPrEPServ_KP_SCORE,
        sets.data_meta_instanceID,
        sets.data_meta_instanceName,
        sets.Facility,
        sets.meta_details,
        sets.data_S_03_01_SIMS_S_03_01_Lube_KP_SCORE_grade,
        sets.data_S_03_02_SIMS_S_03_02_STI_KP_SCORE_grade,
        sets.data_S_03_03_SIMS_S_03_03_PeerOutrchMgmt_SCORE_grade,
        sets.data_S_03_04_SIMS_S_03_04_FP_HIV_IntegrservDel_KPGen_SCORE_grade,
        sets.data_S_03_05_SIMS_S_03_05_KP_PrgmData_SCORE_grade,
        sets.data_S_03_06_SIMS_S_03_06_ProvSensServ_KP_SCORE_grade,
        sets.data_S_03_07_SIMS_S_03_07_ProvPrEPServ_KP_SCORE_grade,
        sets.Set_Average,
        sets.Expected_Average,
        sets.Average_Score,
        sets.Set_ID,
        hubs.Hub
        FROM `{PROJECT_ID}.{STAGING_DATASET}.S_3Atest` as sets
        LEFT JOIN `{PROJECT_ID}.MFL.hub_details` as hubs
        ON cast(sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_FACILITY_MFL as int64) = hubs.MFL_Code
        ''',
        destination_dataset_table = f'{PROJECT_ID}:{STAGING_DATASET}.S_3Atest',
        write_disposition='WRITE_TRUNCATE',
        allow_large_results=True,
        use_legacy_sql=False,
        dag=dag
    )

    t7 = BigQueryOperator(
        task_id='S3B_hubs',
        sql=f'''
        SELECT
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASSR_NAME,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_COUNTY,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_SUB_COUNTY,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_FACILITY,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_FACILITY_MFL,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_TYPE,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_DATE,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_START_TIME,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_END_TIME,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_LOCATION,
        sets.data_S_03_08_SIMS_S_03_08_Retst_Verif_KP_STANDARD,
        sets.data_S_03_08_SIMS_S_03_08_Retst_Verif_KP_INSTRUCTIONS,
        sets.data_S_03_08_SIMS_S_03_08_Retst_Verif_KP_Q1_RESP,
        sets.data_S_03_08_SIMS_S_03_08_Retst_Verif_KP_Q2_RESP,
        sets.data_S_03_08_SIMS_S_03_08_Retst_Verif_KP_Q3_PERC_GRP_generated_table_list_label_19,
        sets.data_S_03_08_SIMS_S_03_08_Retst_Verif_KP_Q3_PERC_GRP_SIMS_S_03_08_Retst_Verif_KP_Q3_PERC,
        sets.data_S_03_08_SIMS_S_03_08_Retst_Verif_KP_Q3_PERC_GRP_SIMS_S_03_08_Retst_Verif_KP_Q3_NUM,
        sets.data_S_03_08_SIMS_S_03_08_Retst_Verif_KP_Q3_PERC_GRP_SIMS_S_03_08_Retst_Verif_KP_Q3_DEN,
        sets.data_S_03_08_SIMS_S_03_08_Retst_Verif_KP_COMM,
        sets.data_S_03_08_SIMS_S_03_08_Retst_Verif_KP_SCORE,
        sets.data_S_03_09_SIMS_S_03_09_PtTrkART_KP_STANDARD,
        sets.data_S_03_09_SIMS_S_03_09_PtTrkART_KP_Q1_RESP,
        sets.data_S_03_09_SIMS_S_03_09_PtTrkART_KP_Q2_PERC_GRP_generated_table_list_label_30,
        sets.data_S_03_09_SIMS_S_03_09_PtTrkART_KP_Q2_PERC_GRP_SIMS_S_03_09_PtTrkART_KP_Q2_PERC,
        sets.data_S_03_09_SIMS_S_03_09_PtTrkART_KP_Q2_PERC_GRP_SIMS_S_03_09_PtTrkART_KP_Q2_NUM,
        sets.data_S_03_09_SIMS_S_03_09_PtTrkART_KP_Q2_PERC_GRP_SIMS_S_03_09_PtTrkART_KP_Q2_DEN,
        sets.data_S_03_09_SIMS_S_03_09_PtTrkART_KP_Q3_PERC_GRP_generated_table_list_label_35,
        sets.data_S_03_09_SIMS_S_03_09_PtTrkART_KP_Q3_PERC_GRP_SIMS_S_03_09_PtTrkART_KP_Q3_PERC,
        sets.data_S_03_09_SIMS_S_03_09_PtTrkART_KP_Q3_PERC_GRP_SIMS_S_03_09_PtTrkART_KP_Q3_NUM,
        sets.data_S_03_09_SIMS_S_03_09_PtTrkART_KP_Q3_PERC_GRP_SIMS_S_03_09_PtTrkART_KP_Q3_DEN,
        sets.data_S_03_09_SIMS_S_03_09_PtTrkART_KP_COMM,
        sets.data_S_03_09_SIMS_S_03_09_PtTrkART_KP_SCORE,
        sets.data_S_03_10_SIMS_S_03_10_RapidART_KP_STANDARD,
        sets.data_S_03_10_SIMS_S_03_10_RapidART_KP_INSTRUCTIONS,
        sets.data_S_03_10_SIMS_S_03_10_RapidART_KP_NA,
        sets.data_S_03_10_SIMS_S_03_10_RapidART_KP_Q1_RESP,
        sets.data_S_03_10_SIMS_S_03_10_RapidART_KP_Q2_PERC_GRP_generated_table_list_label_48,
        sets.data_S_03_10_SIMS_S_03_10_RapidART_KP_Q2_PERC_GRP_SIMS_S_03_10_RapidART_KP_Q2_PERC,
        sets.data_S_03_10_SIMS_S_03_10_RapidART_KP_Q2_PERC_GRP_SIMS_S_03_10_RapidART_KP_Q2_NUM,
        sets.data_S_03_10_SIMS_S_03_10_RapidART_KP_Q2_PERC_GRP_SIMS_S_03_10_RapidART_KP_Q2_DEN,
        sets.data_S_03_10_SIMS_S_03_10_RapidART_KP_COMM,
        sets.data_S_03_10_SIMS_S_03_10_RapidART_KP_SCORE,
        sets.data_S_03_11_SIMS_S_03_11_VLMon_KP_STANDARD,
        sets.data_S_03_11_SIMS_S_03_11_VLMon_KP_Q1_RESP,
        sets.data_S_03_11_SIMS_S_03_11_VLMon_KP_Q2_PERC_GRP_generated_table_list_label_59,
        sets.data_S_03_11_SIMS_S_03_11_VLMon_KP_Q2_PERC_GRP_SIMS_S_03_11_VLMon_KP_Q2_PERC,
        sets.data_S_03_11_SIMS_S_03_11_VLMon_KP_Q2_PERC_GRP_SIMS_S_03_11_VLMon_KP_Q2_NUM,
        sets.data_S_03_11_SIMS_S_03_11_VLMon_KP_Q2_PERC_GRP_SIMS_S_03_11_VLMon_KP_Q2_DEN,
        sets.data_S_03_11_SIMS_S_03_11_VLMon_KP_Q3_PERC_GRP_generated_table_list_label_64,
        sets.data_S_03_11_SIMS_S_03_11_VLMon_KP_Q3_PERC_GRP_SIMS_S_03_11_VLMon_KP_Q3_PERC,
        sets.data_S_03_11_SIMS_S_03_11_VLMon_KP_Q3_PERC_GRP_SIMS_S_03_11_VLMon_KP_Q3_NUM,
        sets.data_S_03_11_SIMS_S_03_11_VLMon_KP_Q3_PERC_GRP_SIMS_S_03_11_VLMon_KP_Q3_DEN,
        sets.data_S_03_11_SIMS_S_03_11_VLMon_KP_COMM,
        sets.data_S_03_11_SIMS_S_03_11_VLMon_KP_SCORE,
        sets.data_S_03_12_SIMS_S_03_12_MgmtVL_KP_STANDARD,
        sets.data_S_03_12_SIMS_S_03_12_MgmtVL_KP_INSTRUCTIONS,
        sets.data_S_03_12_SIMS_S_03_12_MgmtVL_KP_NA,
        sets.data_S_03_12_SIMS_S_03_12_MgmtVL_KP_Q1_T_NUM,
        sets.data_S_03_12_SIMS_S_03_12_MgmtVL_KP_Q2_PERC_GRP_generated_table_list_label_77,
        sets.data_S_03_12_SIMS_S_03_12_MgmtVL_KP_Q2_PERC_GRP_SIMS_S_03_12_MgmtVL_KP_Q2_PERC,
        sets.data_S_03_12_SIMS_S_03_12_MgmtVL_KP_Q2_PERC_GRP_SIMS_S_03_12_MgmtVL_KP_Q2_NUM,
        sets.data_S_03_12_SIMS_S_03_12_MgmtVL_KP_Q2_PERC_GRP_SIMS_S_03_12_MgmtVL_KP_Q2_DEN,
        sets.data_S_03_12_SIMS_S_03_12_MgmtVL_KP_Q3_PERC_GRP_generated_table_list_label_82,
        sets.data_S_03_12_SIMS_S_03_12_MgmtVL_KP_Q3_PERC_GRP_SIMS_S_03_12_MgmtVL_KP_Q3_PERC,
        sets.data_S_03_12_SIMS_S_03_12_MgmtVL_KP_Q3_PERC_GRP_SIMS_S_03_12_MgmtVL_KP_Q3_NUM,
        sets.data_S_03_12_SIMS_S_03_12_MgmtVL_KP_Q3_PERC_GRP_SIMS_S_03_12_MgmtVL_KP_Q3_DEN,
        sets.data_S_03_12_SIMS_S_03_12_MgmtVL_KP_COMM,
        sets.data_S_03_12_SIMS_S_03_12_MgmtVL_KP_SCORE,
        sets.data_S_03_13_SIMS_S_03_13_ApptSpaceMMDrg_TAS_and_DIFFCARE_KP_STANDARD,
        sets.data_S_03_13_SIMS_S_03_13_ApptSpaceMMDrg_TAS_and_DIFFCARE_KP_INSTRUCTIONS,
        sets.data_S_03_13_SIMS_S_03_13_ApptSpaceMMDrg_TAS_and_DIFFCARE_KP_NA,
        sets.data_S_03_13_SIMS_S_03_13_ApptSpaceMMDrg_TAS_and_DIFFCARE_KP_Q1_RESP,
        sets.data_S_03_13_SIMS_S_03_13_ApptSpaceMMDrg_TAS_and_DIFFCARE_KP_Q2_T_NUM,
        sets.data_S_03_13_SIMS_S_03_13_ApptSpaceMMDrg_TAS_and_DIFFCARE_KP_COMM,
        sets.data_S_03_13_SIMS_S_03_13_ApptSpaceMMDrg_TAS_and_DIFFCARE_KP_SCORE,
        sets.data_S_03_14_SIMS_S_03_14_PartnServ_KP_STANDARD,
        sets.data_S_03_14_SIMS_S_03_14_PartnServ_KP_Q1_RESP,
        sets.data_S_03_14_SIMS_S_03_14_PartnServ_KP_Q2_RESP,
        sets.data_S_03_14_SIMS_S_03_14_PartnServ_KP_Q3_PERC_GRP_generated_table_list_label_103,
        sets.data_S_03_14_SIMS_S_03_14_PartnServ_KP_Q3_PERC_GRP_SIMS_S_03_14_PartnServ_KP_Q3_PERC,
        sets.data_S_03_14_SIMS_S_03_14_PartnServ_KP_Q3_PERC_GRP_SIMS_S_03_14_PartnServ_KP_Q3_NUM,
        sets.data_S_03_14_SIMS_S_03_14_PartnServ_KP_Q3_PERC_GRP_SIMS_S_03_14_PartnServ_KP_Q3_DEN,
        sets.data_S_03_14_SIMS_S_03_14_PartnServ_KP_COMM,
        sets.data_S_03_14_SIMS_S_03_14_PartnServ_KP_SCORE,
        sets.data_S_03_15_SIMS_S_03_15_ChildTest_KP_STANDARD,
        sets.data_S_03_15_SIMS_S_03_15_ChildTest_KP_Q1_RESP,
        sets.data_S_03_15_SIMS_S_03_15_ChildTest_KP_Q2_PERC_GRP_generated_table_list_label_114,
        sets.data_S_03_15_SIMS_S_03_15_ChildTest_KP_Q2_PERC_GRP_SIMS_S_03_15_ChildTest_KP_Q2_PERC,
        sets.data_S_03_15_SIMS_S_03_15_ChildTest_KP_Q2_PERC_GRP_SIMS_S_03_15_ChildTest_KP_Q2_NUM,
        sets.data_S_03_15_SIMS_S_03_15_ChildTest_KP_Q2_PERC_GRP_SIMS_S_03_15_ChildTest_KP_Q2_DEN,
        sets.data_S_03_15_SIMS_S_03_15_ChildTest_KP_COMM,
        sets.data_S_03_15_SIMS_S_03_15_ChildTest_KP_SCORE,
        sets.data_S_03_16_SIMS_S_03_16_TBScreen_KP_STANDARD,
        sets.data_S_03_16_SIMS_S_03_16_TBScreen_KP_Q1_RESP,
        sets.data_S_03_16_SIMS_S_03_16_TBScreen_KP_Q2_PERC_GRP_generated_table_list_label_125,
        sets.data_S_03_16_SIMS_S_03_16_TBScreen_KP_Q2_PERC_GRP_SIMS_S_03_16_TBScreen_KP_Q2_PERC,
        sets.data_S_03_16_SIMS_S_03_16_TBScreen_KP_Q2_PERC_GRP_SIMS_S_03_16_TBScreen_KP_Q2_NUM,
        sets.data_S_03_16_SIMS_S_03_16_TBScreen_KP_Q2_PERC_GRP_SIMS_S_03_16_TBScreen_KP_Q2_DEN,
        sets.data_S_03_16_SIMS_S_03_16_TBScreen_KP_COMM,	
        sets.data_S_03_16_SIMS_S_03_16_TBScreen_KP_SCORE,
        sets.data_S_03_17_SIMS_S_03_17_IPT_KP_STANDARD,
        sets.data_S_03_17_SIMS_S_03_17_IPT_KP_Q1_RESP,
        sets.data_S_03_17_SIMS_S_03_17_IPT_KP_Q2_RESP,
        sets.data_S_03_17_SIMS_S_03_17_IPT_KP_Q3_PERC_GRP_generated_table_list_label_137,
        sets.data_S_03_17_SIMS_S_03_17_IPT_KP_Q3_PERC_GRP_SIMS_S_03_17_IPT_KP_Q3_PERC,
        sets.data_S_03_17_SIMS_S_03_17_IPT_KP_Q3_PERC_GRP_SIMS_S_03_17_IPT_KP_Q3_NUM,
        sets.data_S_03_17_SIMS_S_03_17_IPT_KP_Q3_PERC_GRP_SIMS_S_03_17_IPT_KP_Q3_DEN,
        sets.data_S_03_17_SIMS_S_03_17_IPT_KP_COMM,
        sets.data_S_03_17_SIMS_S_03_17_IPT_KP_SCORE,
        sets.data_S_03_18_SIMS_S_03_18_CTXAdult_KP_STANDARD,
        sets.data_S_03_18_SIMS_S_03_18_CTXAdult_KP_INSTRUCTIONS,
        sets.data_S_03_18_SIMS_S_03_18_CTXAdult_KP_NA,
        sets.data_S_03_18_SIMS_S_03_18_CTXAdult_KP_Q1_PERC_GRP_generated_table_list_label_149,
        sets.data_S_03_18_SIMS_S_03_18_CTXAdult_KP_Q1_PERC_GRP_SIMS_S_03_18_CTXAdult_KP_Q1_PERC,
        sets.data_S_03_18_SIMS_S_03_18_CTXAdult_KP_Q1_PERC_GRP_SIMS_S_03_18_CTXAdult_KP_Q1_NUM,
        sets.data_S_03_18_SIMS_S_03_18_CTXAdult_KP_Q1_PERC_GRP_SIMS_S_03_18_CTXAdult_KP_Q1_DEN,
        sets.data_S_03_18_SIMS_S_03_18_CTXAdult_KP_COMM,
        sets.data_S_03_18_SIMS_S_03_18_CTXAdult_KP_SCORE,
        sets.data_S_03_19_SIMS_S_03_19_TBDxEval_KP_STANDARD,
        sets.data_S_03_19_SIMS_S_03_19_TBDxEval_KP_INSTRUCTIONS,
        sets.data_S_03_19_SIMS_S_03_19_TBDxEval_KP_NA,
        sets.data_S_03_19_SIMS_S_03_19_TBDxEval_KP_Q1_RESP,
        sets.data_S_03_19_SIMS_S_03_19_TBDxEval_KP_Q2_RESP,
        sets.data_S_03_19_SIMS_S_03_19_TBDxEval_KP_Q3_PERC_GRP_generated_table_list_label_163,
        sets.data_S_03_19_SIMS_S_03_19_TBDxEval_KP_Q3_PERC_GRP_SIMS_S_03_19_TBDxEval_KP_Q3_PERC,
        sets.data_S_03_19_SIMS_S_03_19_TBDxEval_KP_Q3_PERC_GRP_SIMS_S_03_19_TBDxEval_KP_Q3_NUM,
        sets.data_S_03_19_SIMS_S_03_19_TBDxEval_KP_Q3_PERC_GRP_SIMS_S_03_19_TBDxEval_KP_Q3_DEN,
        sets.data_S_03_19_SIMS_S_03_19_TBDxEval_KP_Q4_PERC_GRP_generated_table_list_label_168,
        sets.data_S_03_19_SIMS_S_03_19_TBDxEval_KP_Q4_PERC_GRP_SIMS_S_03_19_TBDxEval_KP_Q4_PERC,
        sets.data_S_03_19_SIMS_S_03_19_TBDxEval_KP_Q4_PERC_GRP_SIMS_S_03_19_TBDxEval_KP_Q4_NUM,
        sets.data_S_03_19_SIMS_S_03_19_TBDxEval_KP_Q4_PERC_GRP_SIMS_S_03_19_TBDxEval_KP_Q4_DEN,
        sets.data_S_03_19_SIMS_S_03_19_TBDxEval_KP_COMM,
        sets.data_S_03_19_SIMS_S_03_19_TBDxEval_KP_SCORE,
        sets.data_S_03_20_SIMS_S_03_20_CommLinkRetSuppServ_KP_STANDARD,
        sets.data_S_03_20_SIMS_S_03_20_CommLinkRetSuppServ_KP_Q1_T_NUM,
        sets.data_S_03_20_SIMS_S_03_20_CommLinkRetSuppServ_KP_Q2_T_NUM,
        sets.data_S_03_20_SIMS_S_03_20_CommLinkRetSuppServ_KP_COMM,
        sets.data_S_03_20_SIMS_S_03_20_CommLinkRetSuppServ_KP_SCORE,
        sets.data_S_03_21_SIMS_S_03_21_SrvcRefLinkSyst_KP_STANDARD,
        sets.data_S_03_21_SIMS_S_03_21_SrvcRefLinkSyst_KP_Q1_T_NUM,
        sets.data_S_03_21_SIMS_S_03_21_SrvcRefLinkSyst_KP_Q2_PERC_GRP_generated_table_list_label_186,
        sets.data_S_03_21_SIMS_S_03_21_SrvcRefLinkSyst_KP_Q2_PERC_GRP_SIMS_S_03_21_SrvcRefLinkSyst_KP_Q2_PERC,
        sets.data_S_03_21_SIMS_S_03_21_SrvcRefLinkSyst_KP_Q2_PERC_GRP_SIMS_S_03_21_SrvcRefLinkSyst_KP_Q2_NUM,
        sets.data_S_03_21_SIMS_S_03_21_SrvcRefLinkSyst_KP_Q2_PERC_GRP_SIMS_S_03_21_SrvcRefLinkSyst_KP_Q2_DEN,
        sets.data_S_03_21_SIMS_S_03_21_SrvcRefLinkSyst_KP_COMM,
        sets.data_S_03_21_SIMS_S_03_21_SrvcRefLinkSyst_KP_SCORE,
        sets.data_S_03_22_SIMS_S_03_22_FPInteg_KP_STANDARD,
        sets.data_S_03_22_SIMS_S_03_22_FPInteg_KP_Q1_RESP,
        sets.data_S_03_22_SIMS_S_03_22_FPInteg_KP_Q2_RESP,
        sets.data_S_03_22_SIMS_S_03_22_FPInteg_KP_Q3_RESP,
        sets.data_S_03_22_SIMS_S_03_22_FPInteg_KP_Q4_RESP,
        sets.data_S_03_22_SIMS_S_03_22_FPInteg_KP_Q5_RESP,
        sets.data_S_03_22_SIMS_S_03_22_FPInteg_KP_COMM,
        sets.data_S_03_22_SIMS_S_03_22_FPInteg_KP_SCORE,
        sets.data_S_03_23_SIMS_S_03_23_FP_HIV_IntegrservDel_KP_STANDARD,
        sets.data_S_03_23_SIMS_S_03_23_FP_HIV_IntegrservDel_KP_INSTRUCTIONS,
        sets.data_S_03_23_SIMS_S_03_23_FP_HIV_IntegrservDel_KP_NA,
        sets.data_S_03_23_SIMS_S_03_23_FP_HIV_IntegrservDel_KP_Q1_RESP,
        sets.data_S_03_23_SIMS_S_03_23_FP_HIV_IntegrservDel_KP_Q2_RESP,
        sets.data_S_03_23_SIMS_S_03_23_FP_HIV_IntegrservDel_KP_Q3_RESP,
        sets.data_S_03_23_SIMS_S_03_23_FP_HIV_IntegrservDel_KP_Q4_RESP,
        sets.data_S_03_23_SIMS_S_03_23_FP_HIV_IntegrservDel_KP_COMM,
        sets.data_S_03_23_SIMS_S_03_23_FP_HIV_IntegrservDel_KP_SCORE,
        sets.data_S_03_24_SIMS_S_03_24_CervCancScreen_KP_STANDARD,
        sets.data_S_03_24_SIMS_S_03_24_CervCancScreen_KP_INSTRUCTIONS,
        sets.data_S_03_24_SIMS_S_03_24_CervCancScreen_KP_NA,
        sets.data_S_03_24_SIMS_S_03_24_CervCancScreen_KP_Q1_T_NUM,
        sets.data_S_03_24_SIMS_S_03_24_CervCancScreen_KP_Q2_T_NUM,
        sets.data_S_03_24_SIMS_S_03_24_CervCancScreen_KP_Q3_PERC_GRP_generated_table_list_label_221,
        sets.data_S_03_24_SIMS_S_03_24_CervCancScreen_KP_Q3_PERC_GRP_SIMS_S_03_24_CervCancScreen_KP_Q3_PERC,
        sets.data_S_03_24_SIMS_S_03_24_CervCancScreen_KP_Q3_PERC_GRP_SIMS_S_03_24_CervCancScreen_KP_Q3_NUM,
        sets.data_S_03_24_SIMS_S_03_24_CervCancScreen_KP_Q3_PERC_GRP_SIMS_S_03_24_CervCancScreen_KP_Q3_DEN,
        sets.data_S_03_24_SIMS_S_03_24_CervCancScreen_KP_COMM,
        sets.data_S_03_24_SIMS_S_03_24_CervCancScreen_KP_SCORE,
        sets.data_meta_instanceID,
        sets.data_meta_instanceName,
        sets.Facility,
        sets.meta_details,
        sets.data_S_03_08_SIMS_S_03_08_Retst_Verif_KP_SCORE_grade,
        sets.data_S_03_09_SIMS_S_03_09_PtTrkART_KP_SCORE_grade,
        sets.data_S_03_10_SIMS_S_03_10_RapidART_KP_SCORE_grade,
        sets.data_S_03_11_SIMS_S_03_11_VLMon_KP_SCORE_grade,
        sets.data_S_03_12_SIMS_S_03_12_MgmtVL_KP_SCORE_grade,
        sets.data_S_03_13_SIMS_S_03_13_ApptSpaceMMDrg_TAS_and_DIFFCARE_KP_SCORE_grade,
        sets.data_S_03_14_SIMS_S_03_14_PartnServ_KP_SCORE_grade	,
        sets.data_S_03_15_SIMS_S_03_15_ChildTest_KP_SCORE_grade,
        sets.data_S_03_16_SIMS_S_03_16_TBScreen_KP_SCORE_grade,
        sets.data_S_03_17_SIMS_S_03_17_IPT_KP_SCORE_grade,
        sets.data_S_03_18_SIMS_S_03_18_CTXAdult_KP_SCORE_grade,
        sets.data_S_03_19_SIMS_S_03_19_TBDxEval_KP_SCORE_grade,
        sets.data_S_03_20_SIMS_S_03_20_CommLinkRetSuppServ_KP_SCORE_grade,
        sets.data_S_03_21_SIMS_S_03_21_SrvcRefLinkSyst_KP_SCORE_grade,
        sets.data_S_03_22_SIMS_S_03_22_FPInteg_KP_SCORE_grade,
        sets.data_S_03_23_SIMS_S_03_23_FP_HIV_IntegrservDel_KP_SCORE_grade,
        sets.data_S_03_24_SIMS_S_03_24_CervCancScreen_KP_SCORE_grade,
        sets.Set_Average,
        sets.Expected_Average,
        sets.Average_Score,
        sets.Set_ID,
        hubs.Hub
        FROM `{PROJECT_ID}.{STAGING_DATASET}.S_3Btest` as sets
        LEFT JOIN `{PROJECT_ID}.MFL.hub_details` as hubs
        ON cast(sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_FACILITY_MFL as int64) = hubs.MFL_Code
        ''',
        destination_dataset_table = f'{PROJECT_ID}:{STAGING_DATASET}.S_3Btest',
        write_disposition='WRITE_TRUNCATE',
        allow_large_results=True,
        use_legacy_sql=False,
        dag=dag
    )

    t8 = BigQueryOperator(
        task_id='S4A_hubs',
        sql=f'''
        SELECT
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASSR_NAME,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_COUNTY,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_SUB_COUNTY,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_FACILITY,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_FACILITY_MFL,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_TYPE,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_DATE,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_START_TIME,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_END_TIME,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_LOCATION,
        sets.data_S_04_01_SIMS_S_04_01_Retst_Verif_PMTCT_STANDARD,
        sets.data_S_04_01_SIMS_S_04_01_Retst_Verif_PMTCT_INSTRUCTIONS,
        sets.data_S_04_01_SIMS_S_04_01_Retst_Verif_PMTCT_Q1_RESP,
        sets.data_S_04_01_SIMS_S_04_01_Retst_Verif_PMTCT_Q2_RESP,
        sets.data_S_04_01_SIMS_S_04_01_Retst_Verif_PMTCT_Q3_PERC_GRP_generated_table_list_label_19,
        sets.data_S_04_01_SIMS_S_04_01_Retst_Verif_PMTCT_Q3_PERC_GRP_SIMS_S_04_01_Retst_Verif_PMTCT_Q3_PERC,
        sets.data_S_04_01_SIMS_S_04_01_Retst_Verif_PMTCT_Q3_PERC_GRP_SIMS_S_04_01_Retst_Verif_PMTCT_Q3_NUM,
        sets.data_S_04_01_SIMS_S_04_01_Retst_Verif_PMTCT_Q3_PERC_GRP_SIMS_S_04_01_Retst_Verif_PMTCT_Q3_DEN,
        sets.data_S_04_01_SIMS_S_04_01_Retst_Verif_PMTCT_COMM,
        sets.data_S_04_01_SIMS_S_04_01_Retst_Verif_PMTCT_SCORE,
        sets.data_S_04_02_SIMS_S_04_02_PtTrkPreg_STANDARD,
        sets.data_S_04_02_SIMS_S_04_02_PtTrkPreg_Q1_RESP,
        sets.data_S_04_02_SIMS_S_04_02_PtTrkPreg_Q2_PERC_GRP_generated_table_list_label_30,
        sets.data_S_04_02_SIMS_S_04_02_PtTrkPreg_Q2_PERC_GRP_SIMS_S_04_02_PtTrkPreg_Q2_PERC,
        sets.data_S_04_02_SIMS_S_04_02_PtTrkPreg_Q2_PERC_GRP_SIMS_S_04_02_PtTrkPreg_Q2_NUM,
        sets.data_S_04_02_SIMS_S_04_02_PtTrkPreg_Q2_PERC_GRP_SIMS_S_04_02_PtTrkPreg_Q2_DEN,
        sets.data_S_04_02_SIMS_S_04_02_PtTrkPreg_Q3_PERC_GRP_generated_table_list_label_35,
        sets.data_S_04_02_SIMS_S_04_02_PtTrkPreg_Q3_PERC_GRP_SIMS_S_04_02_PtTrkPreg_Q3_PERC,
        sets.data_S_04_02_SIMS_S_04_02_PtTrkPreg_Q3_PERC_GRP_SIMS_S_04_02_PtTrkPreg_Q3_NUM,
        sets.data_S_04_02_SIMS_S_04_02_PtTrkPreg_Q3_PERC_GRP_SIMS_S_04_02_PtTrkPreg_Q3_DEN,
        sets.data_S_04_02_SIMS_S_04_02_PtTrkPreg_COMM,
        sets.data_S_04_02_SIMS_S_04_02_PtTrkPreg_SCORE,
        sets.data_S_04_03_SIMS_S_04_03_VLMon_PMTCT_STANDARD,
        sets.data_S_04_03_SIMS_S_04_03_VLMon_PMTCT_Q1_RESP,
        sets.data_S_04_03_SIMS_S_04_03_VLMon_PMTCT_Q2_PERC_GRP_generated_table_list_label_46,
        sets.data_S_04_03_SIMS_S_04_03_VLMon_PMTCT_Q2_PERC_GRP_SIMS_S_04_03_VLMon_PMTCT_Q2_PERC,
        sets.data_S_04_03_SIMS_S_04_03_VLMon_PMTCT_Q2_PERC_GRP_SIMS_S_04_03_VLMon_PMTCT_Q2_NUM,
        sets.data_S_04_03_SIMS_S_04_03_VLMon_PMTCT_Q2_PERC_GRP_SIMS_S_04_03_VLMon_PMTCT_Q2_DEN,
        sets.data_S_04_03_SIMS_S_04_03_VLMon_PMTCT_Q3_PERC_GRP_generated_table_list_label_51,
        sets.data_S_04_03_SIMS_S_04_03_VLMon_PMTCT_Q3_PERC_GRP_SIMS_S_04_03_VLMon_PMTCT_Q3_PERC,
        sets.data_S_04_03_SIMS_S_04_03_VLMon_PMTCT_Q3_PERC_GRP_SIMS_S_04_03_VLMon_PMTCT_Q3_NUM,
        sets.data_S_04_03_SIMS_S_04_03_VLMon_PMTCT_Q3_PERC_GRP_SIMS_S_04_03_VLMon_PMTCT_Q3_DEN,
        sets.data_S_04_03_SIMS_S_04_03_VLMon_PMTCT_COMM,
        sets.data_S_04_03_SIMS_S_04_03_VLMon_PMTCT_SCORE,
        sets.data_S_04_04_SIMS_S_04_04_MgmtVL_PMTCT_STANDARD,
        sets.data_S_04_04_SIMS_S_04_04_MgmtVL_PMTCT_INSTRUCTIONS,
        sets.data_S_04_04_SIMS_S_04_04_MgmtVL_PMTCT_NA,
        sets.data_S_04_04_SIMS_S_04_04_MgmtVL_PMTCT_Q1_T_NUM,
        sets.data_S_04_04_SIMS_S_04_04_MgmtVL_PMTCT_Q2_PERC_GRP_generated_table_list_label_64,
        sets.data_S_04_04_SIMS_S_04_04_MgmtVL_PMTCT_Q2_PERC_GRP_SIMS_S_04_04_MgmtVL_PMTCT_Q2_PERC,
        sets.data_S_04_04_SIMS_S_04_04_MgmtVL_PMTCT_Q2_PERC_GRP_SIMS_S_04_04_MgmtVL_PMTCT_Q2_NUM,
        sets.data_S_04_04_SIMS_S_04_04_MgmtVL_PMTCT_Q2_PERC_GRP_SIMS_S_04_04_MgmtVL_PMTCT_Q2_DEN,
        sets.data_S_04_04_SIMS_S_04_04_MgmtVL_PMTCT_Q3_PERC_GRP_generated_table_list_label_69,
        sets.data_S_04_04_SIMS_S_04_04_MgmtVL_PMTCT_Q3_PERC_GRP_SIMS_S_04_04_MgmtVL_PMTCT_Q3_PERC,
        sets.data_S_04_04_SIMS_S_04_04_MgmtVL_PMTCT_Q3_PERC_GRP_SIMS_S_04_04_MgmtVL_PMTCT_Q3_NUM,
        sets.data_S_04_04_SIMS_S_04_04_MgmtVL_PMTCT_Q3_PERC_GRP_SIMS_S_04_04_MgmtVL_PMTCT_Q3_DEN,
        sets.data_S_04_04_SIMS_S_04_04_MgmtVL_PMTCT_COMM,
        sets.data_S_04_04_SIMS_S_04_04_MgmtVL_PMTCT_SCORE,
        sets.data_S_04_05_SIMS_S_04_05_ApptSpaceMMDrg_TAS_and_DIFFCARE_PMTCT_STANDARD,
        sets.data_S_04_05_SIMS_S_04_05_ApptSpaceMMDrg_TAS_and_DIFFCARE_PMTCT_INSTRUCTIONS,
        sets.data_S_04_05_SIMS_S_04_05_ApptSpaceMMDrg_TAS_and_DIFFCARE_PMTCT_NA,
        sets.data_S_04_05_SIMS_S_04_05_ApptSpaceMMDrg_TAS_and_DIFFCARE_PMTCT_Q1_RESP,
        sets.data_S_04_05_SIMS_S_04_05_ApptSpaceMMDrg_TAS_and_DIFFCARE_PMTCT_Q2_T_NUM,
        sets.data_S_04_05_SIMS_S_04_05_ApptSpaceMMDrg_TAS_and_DIFFCARE_PMTCT_COMM,
        sets.data_S_04_05_SIMS_S_04_05_ApptSpaceMMDrg_TAS_and_DIFFCARE_PMTCT_SCORE,
        sets.data_S_04_06_SIMS_S_04_06_SupServPregAdol_ANC_STANDARD,
        sets.data_S_04_06_SIMS_S_04_06_SupServPregAdol_ANC_INSTRUCTIONS,
        sets.data_S_04_06_SIMS_S_04_06_SupServPregAdol_ANC_NA,
        sets.data_S_04_06_SIMS_S_04_06_SupServPregAdol_ANC_Q1_T_NUM,
        sets.data_S_04_06_SIMS_S_04_06_SupServPregAdol_ANC_COMM,
        sets.data_S_04_06_SIMS_S_04_06_SupServPregAdol_ANC_SCORE,
        sets.data_S_04_07_SIMS_S_04_07_PartnServ_PMTCT_STANDARD,
        sets.data_S_04_07_SIMS_S_04_07_PartnServ_PMTCT_Q1_RESP,
        sets.data_S_04_07_SIMS_S_04_07_PartnServ_PMTCT_Q2_RESP,
        sets.data_S_04_07_SIMS_S_04_07_PartnServ_PMTCT_Q3_PERC_GRP_generated_table_list_label_98,
        sets.data_S_04_07_SIMS_S_04_07_PartnServ_PMTCT_Q3_PERC_GRP_SIMS_S_04_07_PartnServ_PMTCT_Q3_PERC,
        sets.data_S_04_07_SIMS_S_04_07_PartnServ_PMTCT_Q3_PERC_GRP_SIMS_S_04_07_PartnServ_PMTCT_Q3_NUM,
        sets.data_S_04_07_SIMS_S_04_07_PartnServ_PMTCT_Q3_PERC_GRP_SIMS_S_04_07_PartnServ_PMTCT_Q3_DEN,
        sets.data_S_04_07_SIMS_S_04_07_PartnServ_PMTCT_COMM,
        sets.data_S_04_07_SIMS_S_04_07_PartnServ_PMTCT_SCORE,
        sets.data_S_04_08_SIMS_S_04_08_ChildTest_PMTCT_STANDARD,
        sets.data_S_04_08_SIMS_S_04_08_ChildTest_PMTCT_Q1_RESP,
        sets.data_S_04_08_SIMS_S_04_08_ChildTest_PMTCT_Q2_PERC_GRP_generated_table_list_label_109,
        sets.data_S_04_08_SIMS_S_04_08_ChildTest_PMTCT_Q2_PERC_GRP_SIMS_S_04_08_ChildTest_PMTCT_Q2_PERC,
        sets.data_S_04_08_SIMS_S_04_08_ChildTest_PMTCT_Q2_PERC_GRP_SIMS_S_04_08_ChildTest_PMTCT_Q2_NUM,
        sets.data_S_04_08_SIMS_S_04_08_ChildTest_PMTCT_Q2_PERC_GRP_SIMS_S_04_08_ChildTest_PMTCT_Q2_DEN,
        sets.data_S_04_08_SIMS_S_04_08_ChildTest_PMTCT_COMM,
        sets.data_S_04_08_SIMS_S_04_08_ChildTest_PMTCT_SCORE,
        sets.data_S_04_09_SIMS_S_04_09_TBScreen_PMTCT_STANDARD,
        sets.data_S_04_09_SIMS_S_04_09_TBScreen_PMTCT_Q1_RESP,
        sets.data_S_04_09_SIMS_S_04_09_TBScreen_PMTCT_Q2_PERC_GRP_generated_table_list_label_120,
        sets.data_S_04_09_SIMS_S_04_09_TBScreen_PMTCT_Q2_PERC_GRP_SIMS_S_04_09_TBScreen_PMTCT_Q2_PERC,
        sets.data_S_04_09_SIMS_S_04_09_TBScreen_PMTCT_Q2_PERC_GRP_SIMS_S_04_09_TBScreen_PMTCT_Q2_NUM,
        sets.data_S_04_09_SIMS_S_04_09_TBScreen_PMTCT_Q2_PERC_GRP_SIMS_S_04_09_TBScreen_PMTCT_Q2_DEN,
        sets.data_S_04_09_SIMS_S_04_09_TBScreen_PMTCT_COMM,
        sets.data_S_04_09_SIMS_S_04_09_TBScreen_PMTCT_SCORE,
        sets.data_S_04_10_SIMS_S_04_10_IPT_PMTCT_STANDARD,
        sets.data_S_04_10_SIMS_S_04_10_IPT_PMTCT_Q1_RESP,
        sets.data_S_04_10_SIMS_S_04_10_IPT_PMTCT_Q2_RESP,
        sets.data_S_04_10_SIMS_S_04_10_IPT_PMTCT_Q3_PERC_GRP_generated_table_list_label_132,
        sets.data_S_04_10_SIMS_S_04_10_IPT_PMTCT_Q3_PERC_GRP_SIMS_S_04_10_IPT_PMTCT_Q3_PERC,
        sets.data_S_04_10_SIMS_S_04_10_IPT_PMTCT_Q3_PERC_GRP_SIMS_S_04_10_IPT_PMTCT_Q3_NUM,
        sets.data_S_04_10_SIMS_S_04_10_IPT_PMTCT_Q3_PERC_GRP_SIMS_S_04_10_IPT_PMTCT_Q3_DEN,
        sets.data_S_04_10_SIMS_S_04_10_IPT_PMTCT_COMM,
        sets.data_S_04_10_SIMS_S_04_10_IPT_PMTCT_SCORE,
        sets.data_S_04_11_SIMS_S_04_11_CTX_PMTCT_STANDARD,
        sets.data_S_04_11_SIMS_S_04_11_CTX_PMTCT_INSTRUCTIONS,
        sets.data_S_04_11_SIMS_S_04_11_CTX_PMTCT_NA,
        sets.data_S_04_11_SIMS_S_04_11_CTX_PMTCT_Q1_PERC_GRP_generated_table_list_label_144,
        sets.data_S_04_11_SIMS_S_04_11_CTX_PMTCT_Q1_PERC_GRP_SIMS_S_04_11_CTX_PMTCT_Q1_PERC,
        sets.data_S_04_11_SIMS_S_04_11_CTX_PMTCT_Q1_PERC_GRP_SIMS_S_04_11_CTX_PMTCT_Q1_NUM,
        sets.data_S_04_11_SIMS_S_04_11_CTX_PMTCT_Q1_PERC_GRP_SIMS_S_04_11_CTX_PMTCT_Q1_DEN,
        sets.data_S_04_11_SIMS_S_04_11_CTX_PMTCT_COMM,
        sets.data_S_04_11_SIMS_S_04_11_CTX_PMTCT_SCORE,
        sets.data_S_04_12_SIMS_S_04_12_TBDxEval_PMTCT_STANDARD,
        sets.data_S_04_12_SIMS_S_04_12_TBDxEval_PMTCT_INSTRUCTIONS,
        sets.data_S_04_12_SIMS_S_04_12_TBDxEval_PMTCT_NA,
        sets.data_S_04_12_SIMS_S_04_12_TBDxEval_PMTCT_Q1_RESP,
        sets.data_S_04_12_SIMS_S_04_12_TBDxEval_PMTCT_Q2_RESP,
        sets.data_S_04_12_SIMS_S_04_12_TBDxEval_PMTCT_Q3_PERC_GRP_generated_table_list_label_158,
        sets.data_S_04_12_SIMS_S_04_12_TBDxEval_PMTCT_Q3_PERC_GRP_SIMS_S_04_12_TBDxEval_PMTCT_Q3_PERC,
        sets.data_S_04_12_SIMS_S_04_12_TBDxEval_PMTCT_Q3_PERC_GRP_SIMS_S_04_12_TBDxEval_PMTCT_Q3_NUM,
        sets.data_S_04_12_SIMS_S_04_12_TBDxEval_PMTCT_Q3_PERC_GRP_SIMS_S_04_12_TBDxEval_PMTCT_Q3_DEN,
        sets.data_S_04_12_SIMS_S_04_12_TBDxEval_PMTCT_Q4_PERC_GRP_generated_table_list_label_163,
        sets.data_S_04_12_SIMS_S_04_12_TBDxEval_PMTCT_Q4_PERC_GRP_SIMS_S_04_12_TBDxEval_PMTCT_Q4_PERC,
        sets.data_S_04_12_SIMS_S_04_12_TBDxEval_PMTCT_Q4_PERC_GRP_SIMS_S_04_12_TBDxEval_PMTCT_Q4_NUM,
        sets.data_S_04_12_SIMS_S_04_12_TBDxEval_PMTCT_Q4_PERC_GRP_SIMS_S_04_12_TBDxEval_PMTCT_Q4_DEN,
        sets.data_S_04_12_SIMS_S_04_12_TBDxEval_PMTCT_COMM,
        sets.data_S_04_12_SIMS_S_04_12_TBDxEval_PMTCT_SCORE,
        sets.data_S_04_13_SIMS_S_04_13_PITC_L_and_D_STANDARD,
        sets.data_S_04_13_SIMS_S_04_13_PITC_L_and_D_INSTRUCTIONS,
        sets.data_S_04_13_SIMS_S_04_13_PITC_L_and_D_NA,
        sets.data_S_04_13_SIMS_S_04_13_PITC_L_and_D_Q1_RESP,
        sets.data_S_04_13_SIMS_S_04_13_PITC_L_and_D_Q2_PERC_GRP_generated_table_list_label_176,
        sets.data_S_04_13_SIMS_S_04_13_PITC_L_and_D_Q2_PERC_GRP_SIMS_S_04_13_PITC_L_and_D_Q2_PERC,
        sets.data_S_04_13_SIMS_S_04_13_PITC_L_and_D_Q2_PERC_GRP_SIMS_S_04_13_PITC_L_and_D_Q2_NUM,
        sets.data_S_04_13_SIMS_S_04_13_PITC_L_and_D_Q2_PERC_GRP_SIMS_S_04_13_PITC_L_and_D_Q2_DEN,
        sets.data_S_04_13_SIMS_S_04_13_PITC_L_and_D_COMM,
        sets.data_S_04_13_SIMS_S_04_13_PITC_L_and_D_SCORE,
        sets.data_S_04_14_SIMS_S_04_14_ARV_L_and_D_STANDARD,
        sets.data_S_04_14_SIMS_S_04_14_ARV_L_and_D_INSTRUCTIONS,
        sets.data_S_04_14_SIMS_S_04_14_ARV_L_and_D_NA,
        sets.data_S_04_14_SIMS_S_04_14_ARV_L_and_D_Q1_RESP,
        sets.data_S_04_14_SIMS_S_04_14_ARV_L_and_D_Q2_PERC_GRP_generated_table_list_label_189,
        sets.data_S_04_14_SIMS_S_04_14_ARV_L_and_D_Q2_PERC_GRP_SIMS_S_04_14_ARV_L_and_D_Q2_PERC,
        sets.data_S_04_14_SIMS_S_04_14_ARV_L_and_D_Q2_PERC_GRP_SIMS_S_04_14_ARV_L_and_D_Q2_NUM,
        sets.data_S_04_14_SIMS_S_04_14_ARV_L_and_D_Q2_PERC_GRP_SIMS_S_04_14_ARV_L_and_D_Q2_DEN,
        sets.data_S_04_14_SIMS_S_04_14_ARV_L_and_D_COMM,
        sets.data_S_04_14_SIMS_S_04_14_ARV_L_and_D_SCORE,
        sets.data_meta_instanceID,
        sets.data_meta_instanceName,
        sets.Facility,
        sets.meta_details,
        sets.data_S_04_01_SIMS_S_04_01_Retst_Verif_PMTCT_SCORE_grade,
        sets.data_S_04_02_SIMS_S_04_02_PtTrkPreg_SCORE_grade,
        sets.data_S_04_03_SIMS_S_04_03_VLMon_PMTCT_SCORE_grade,
        sets.data_S_04_04_SIMS_S_04_04_MgmtVL_PMTCT_SCORE_grade,
        sets.data_S_04_05_SIMS_S_04_05_ApptSpaceMMDrg_TAS_and_DIFFCARE_PMTCT_SCORE_grade,
        sets.data_S_04_06_SIMS_S_04_06_SupServPregAdol_ANC_SCORE_grade,
        sets.data_S_04_07_SIMS_S_04_07_PartnServ_PMTCT_SCORE_grade,
        sets.data_S_04_08_SIMS_S_04_08_ChildTest_PMTCT_SCORE_grade,
        sets.data_S_04_09_SIMS_S_04_09_TBScreen_PMTCT_SCORE_grade,
        sets.data_S_04_10_SIMS_S_04_10_IPT_PMTCT_SCORE_grade,
        sets.data_S_04_11_SIMS_S_04_11_CTX_PMTCT_SCORE_grade,
        sets.data_S_04_12_SIMS_S_04_12_TBDxEval_PMTCT_SCORE_grade,
        sets.data_S_04_13_SIMS_S_04_13_PITC_L_and_D_SCORE_grade,
        sets.data_S_04_14_SIMS_S_04_14_ARV_L_and_D_SCORE_grade,
        sets.Set_Average,
        sets.Expected_Average,
        sets.Average_Score,
        sets.Set_ID,
        hubs.Hub
        FROM `{PROJECT_ID}.{STAGING_DATASET}.S_4Atest` as sets
        LEFT JOIN `{PROJECT_ID}.MFL.hub_details` as hubs
        ON cast(sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_FACILITY_MFL as int64) = hubs.MFL_Code
        ''',
        destination_dataset_table = f'{PROJECT_ID}:{STAGING_DATASET}.S_4Atest',
        write_disposition='WRITE_TRUNCATE',
        allow_large_results=True,
        use_legacy_sql=False,
        dag=dag
    )

    t9 = BigQueryOperator(
        task_id='S4B_hubs',
        sql=f'''
        SELECT
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASSR_NAME,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_COUNTY,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_SUB_COUNTY,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_FACILITY,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_FACILITY_MFL,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_TYPE,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_DATE,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_START_TIME,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_END_TIME,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_LOCATION,
        sets.data_S_04_15_SIMS_S_04_15_EID_HEI_STANDARD,
        sets.data_S_04_15_SIMS_S_04_15_EID_HEI_INSTRUCTIONS,
        sets.data_S_04_15_SIMS_S_04_15_EID_HEI_NA,
        sets.data_S_04_15_SIMS_S_04_15_EID_HEI_INSTR_T_NUM,
        sets.data_S_04_15_SIMS_S_04_15_EID_HEI_Q1_PERC_GRP_generated_table_list_label_19,
        sets.data_S_04_15_SIMS_S_04_15_EID_HEI_Q1_PERC_GRP_SIMS_S_04_15_EID_HEI_Q1_PERC,
        sets.data_S_04_15_SIMS_S_04_15_EID_HEI_Q1_PERC_GRP_SIMS_S_04_15_EID_HEI_Q1_NUM,
        sets.data_S_04_15_SIMS_S_04_15_EID_HEI_Q1_PERC_GRP_SIMS_S_04_15_EID_HEI_Q1_DEN,
        sets.data_S_04_15_SIMS_S_04_15_EID_HEI_Q2_PERC_GRP_generated_table_list_label_24,
        sets.data_S_04_15_SIMS_S_04_15_EID_HEI_Q2_PERC_GRP_SIMS_S_04_15_EID_HEI_Q2_PERC,
        sets.data_S_04_15_SIMS_S_04_15_EID_HEI_Q2_PERC_GRP_SIMS_S_04_15_EID_HEI_Q2_NUM,
        sets.data_S_04_15_SIMS_S_04_15_EID_HEI_Q2_PERC_GRP_SIMS_S_04_15_EID_HEI_Q2_DEN,
        sets.data_S_04_15_SIMS_S_04_15_EID_HEI_COMM,
        sets.data_S_04_15_SIMS_S_04_15_EID_HEI_SCORE,
        sets.data_S_04_16_SIMS_S_04_16_PtTrk_HEI_STANDARD,
        sets.data_S_04_16_SIMS_S_04_16_PtTrk_HEI_INSTRUCTIONS,
        sets.data_S_04_16_SIMS_S_04_16_PtTrk_HEI_NA,
        sets.data_S_04_16_SIMS_S_04_16_PtTrk_HEI_Q1_RESP,
        sets.data_S_04_16_SIMS_S_04_16_PtTrk_HEI_Q2_RESP,
        sets.data_S_04_16_SIMS_S_04_16_PtTrk_HEI_Q3_RESP,
        sets.data_S_04_16_SIMS_S_04_16_PtTrk_HEI_COMM,
        sets.data_S_04_16_SIMS_S_04_16_PtTrk_HEI_SCORE,
        sets.data_S_04_17_SIMS_S_04_17_ConfirmTest_STANDARD,
        sets.data_S_04_17_SIMS_S_04_17_ConfirmTest_INSTRUCTIONS,
        sets.data_S_04_17_SIMS_S_04_17_ConfirmTest_NA,
        sets.data_S_04_17_SIMS_S_04_17_ConfirmTest_Q1_PERC_GRP_generated_table_list_label_46,
        sets.data_S_04_17_SIMS_S_04_17_ConfirmTest_Q1_PERC_GRP_SIMS_S_04_17_ConfirmTest_Q1_PERC,
        sets.data_S_04_17_SIMS_S_04_17_ConfirmTest_Q1_PERC_GRP_SIMS_S_04_17_ConfirmTest_Q1_NUM,
        sets.data_S_04_17_SIMS_S_04_17_ConfirmTest_Q1_PERC_GRP_SIMS_S_04_17_ConfirmTest_Q1_DEN,
        sets.data_S_04_17_SIMS_S_04_17_ConfirmTest_COMM,
        sets.data_S_04_17_SIMS_S_04_17_ConfirmTest_SCORE,
        sets.data_S_04_18_SIMS_S_04_18_CTX_HEI_STANDARD,
        sets.data_S_04_18_SIMS_S_04_18_CTX_HEI_INSTRUCTIONS,
        sets.data_S_04_18_SIMS_S_04_18_CTX_HEI_NA,
        sets.data_S_04_18_SIMS_S_04_18_CTX_HEI_Q1_PERC_GRP_generated_table_list_label_58,
        sets.data_S_04_18_SIMS_S_04_18_CTX_HEI_Q1_PERC_GRP_SIMS_S_04_18_CTX_HEI_Q1_PERC,
        sets.data_S_04_18_SIMS_S_04_18_CTX_HEI_Q1_PERC_GRP_SIMS_S_04_18_CTX_HEI_Q1_NUM,
        sets.data_S_04_18_SIMS_S_04_18_CTX_HEI_Q1_PERC_GRP_SIMS_S_04_18_CTX_HEI_Q1_DEN,
        sets.data_S_04_18_SIMS_S_04_18_CTX_HEI_COMM,
        sets.data_S_04_18_SIMS_S_04_18_CTX_HEI_SCORE,
        sets.data_S_04_19_SIMS_S_04_19_FollowUp_HEI_STANDARD,
        sets.data_S_04_19_SIMS_S_04_19_FollowUp_HEI_INSTRUCTIONS,
        sets.data_S_04_19_SIMS_S_04_19_FollowUp_HEI_NA,
        sets.data_S_04_19_SIMS_S_04_19_FollowUp_HEI_Q1_RESP,
        sets.data_S_04_19_SIMS_S_04_19_FollowUp_HEI_Q2_PERC_GRP_generated_table_list_label_71,
        sets.data_S_04_19_SIMS_S_04_19_FollowUp_HEI_Q2_PERC_GRP_SIMS_S_04_19_FollowUp_HEI_Q2_PERC,
        sets.data_S_04_19_SIMS_S_04_19_FollowUp_HEI_Q2_PERC_GRP_SIMS_S_04_19_FollowUp_HEI_Q2_NUM,
        sets.data_S_04_19_SIMS_S_04_19_FollowUp_HEI_Q2_PERC_GRP_SIMS_S_04_19_FollowUp_HEI_Q2_DEN,
        sets.data_S_04_19_SIMS_S_04_19_FollowUp_HEI_COMM,
        sets.data_S_04_19_SIMS_S_04_19_FollowUp_HEI_SCORE,
        sets.data_S_04_20_SIMS_S_04_20_ARTEnrol_HEI_STANDARD,
        sets.data_S_04_20_SIMS_S_04_20_ARTEnrol_HEI_INSTRUCTIONS,
        sets.data_S_04_20_SIMS_S_04_20_ARTEnrol_HEI_NA,
        sets.data_S_04_20_SIMS_S_04_20_ARTEnrol_HEI_Q1_RESP,
        sets.data_S_04_20_SIMS_S_04_20_ARTEnrol_HEI_Q2_PERC_GRP_generated_table_list_label_84,
        sets.data_S_04_20_SIMS_S_04_20_ARTEnrol_HEI_Q2_PERC_GRP_SIMS_S_04_20_ARTEnrol_HEI_Q2_PERC,
        sets.data_S_04_20_SIMS_S_04_20_ARTEnrol_HEI_Q2_PERC_GRP_SIMS_S_04_20_ARTEnrol_HEI_Q2_NUM,
        sets.data_S_04_20_SIMS_S_04_20_ARTEnrol_HEI_Q2_PERC_GRP_SIMS_S_04_20_ARTEnrol_HEI_Q2_DEN,
        sets.data_S_04_20_SIMS_S_04_20_ARTEnrol_HEI_COMM,
        sets.data_S_04_20_SIMS_S_04_20_ARTEnrol_HEI_SCORE,
        sets.data_S_04_21_SIMS_S_04_21_EIDSupChn_HEI_STANDARD,
        sets.data_S_04_21_SIMS_S_04_21_EIDSupChn_HEI_INSTRUCTIONS,
        sets.data_S_04_21_SIMS_S_04_21_EIDSupChn_HEI_NA,
        sets.data_S_04_21_SIMS_S_04_21_EIDSupChn_HEI_Q1_RESP,
        sets.data_S_04_21_SIMS_S_04_21_EIDSupChn_HEI_Q2_RESP,
        sets.data_S_04_21_SIMS_S_04_21_EIDSupChn_HEI_Q3_RESP,
        sets.data_S_04_21_SIMS_S_04_21_EIDSupChn_HEI_COMM,
        sets.data_S_04_21_SIMS_S_04_21_EIDSupChn_HEI_SCORE,
        sets.data_meta_instanceID,
        sets.data_meta_instanceName,
        sets.Facility,
        sets.meta_details,	
        sets.data_S_04_15_SIMS_S_04_15_EID_HEI_SCORE_grade,
        sets.data_S_04_16_SIMS_S_04_16_PtTrk_HEI_SCORE_grade,
        sets.data_S_04_17_SIMS_S_04_17_ConfirmTest_SCORE_grade,
        sets.data_S_04_18_SIMS_S_04_18_CTX_HEI_SCORE_grade,
        sets.data_S_04_19_SIMS_S_04_19_FollowUp_HEI_SCORE_grade,
        sets.data_S_04_20_SIMS_S_04_20_ARTEnrol_HEI_SCORE_grade,
        sets.data_S_04_21_SIMS_S_04_21_EIDSupChn_HEI_SCORE_grade,
        sets.Set_Average,
        sets.Expected_Average,
        sets.Average_Score,
        sets.Set_ID,
        hubs.Hub
        FROM `{PROJECT_ID}.{STAGING_DATASET}.S_4Btest` as sets
        LEFT JOIN `{PROJECT_ID}.MFL.hub_details` as hubs
        ON cast(sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_FACILITY_MFL as int64) = hubs.MFL_Code
        ''',
        destination_dataset_table = f'{PROJECT_ID}:{STAGING_DATASET}.S_4Btest',
        write_disposition='WRITE_TRUNCATE',
        allow_large_results=True,
        use_legacy_sql=False,
        dag=dag
    )

    t10 = BigQueryOperator(
        task_id='S6_hubs',
        sql=f'''
        SELECT
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASSR_NAME,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_COUNTY,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_SUB_COUNTY,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_FACILITY,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_FACILITY_MFL,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_TYPE,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_DATE,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_START_TIME,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_END_TIME,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_LOCATION,
        sets.data_S_06_01_SIMS_S_06_01_PostViolCap_GBV_STANDARD,
        sets.data_S_06_01_SIMS_S_06_01_PostViolCap_GBV_INSTRUCTIONS,
        sets.data_S_06_01_SIMS_S_06_01_PostViolCap_GBV_NA,
        sets.data_S_06_01_SIMS_S_06_01_PostViolCap_GBV_Q1_RESP,
        sets.data_S_06_01_SIMS_S_06_01_PostViolCap_GBV_Q2_T_NUM,
        sets.data_S_06_01_SIMS_S_06_01_PostViolCap_GBV_Q3_RESP,
        sets.data_S_06_01_SIMS_S_06_01_PostViolCap_GBV_Q4_T_NUM,
        sets.data_S_06_01_SIMS_S_06_01_PostViolCap_GBV_COMM,
        sets.data_S_06_01_SIMS_S_06_01_PostViolCap_GBV_SCORE,
        sets.data_S_06_02_SIMS_S_06_02_PostViolAvail_GBV_STANDARD,
        sets.data_S_06_02_SIMS_S_06_02_PostViolAvail_GBV_INSTRUCTIONS,
        sets.data_S_06_02_SIMS_S_06_02_PostViolAvail_GBV_NA,
        sets.data_S_06_02_SIMS_S_06_02_PostViolAvail_GBV_Q1_RESP,
        sets.data_S_06_02_SIMS_S_06_02_PostViolAvail_GBV_Q2_T_NUM,
        sets.data_S_06_02_SIMS_S_06_02_PostViolAvail_GBV_Q3_T_NUM,
        sets.data_S_06_02_SIMS_S_06_02_PostViolAvail_GBV_COMM,
        sets.data_S_06_02_SIMS_S_06_02_PostViolAvail_GBV_SCORE,
        sets.data_S_06_03_SIMS_S_06_03_GenNorm_STANDARD,
        sets.data_S_06_03_SIMS_S_06_03_GenNorm_INSTRUCTIONS,
        sets.data_S_06_03_SIMS_S_06_03_GenNorm_NA,
        sets.data_S_06_03_SIMS_S_06_03_GenNorm_Q1_T_NUM,
        sets.data_S_06_03_SIMS_S_06_03_GenNorm_Q2_RESP,
        sets.data_S_06_03_SIMS_S_06_03_GenNorm_Q3_T_NUM,
        sets.data_S_06_03_SIMS_S_06_03_GenNorm_COMM,
        sets.data_S_06_03_SIMS_S_06_03_GenNorm_SCORE,
        sets.data_S_06_04_SIMS_S_06_04_CaseMgmt_Serv_STANDARD,
        sets.data_S_06_04_SIMS_S_06_04_CaseMgmt_Serv_INSTRUCTIONS,
        sets.data_S_06_04_SIMS_S_06_04_CaseMgmt_Serv_NA,
        sets.data_S_06_04_SIMS_S_06_04_CaseMgmt_Serv_Q1_T_NUM,
        sets.data_S_06_04_SIMS_S_06_04_CaseMgmt_Serv_Q2_T_NUM,
        sets.data_S_06_04_SIMS_S_06_04_CaseMgmt_Serv_Q3_T_NUM,
        sets.data_S_06_04_SIMS_S_06_04_CaseMgmt_Serv_COMM,
        sets.data_S_06_04_SIMS_S_06_04_CaseMgmt_Serv_SCORE,
        sets.data_S_06_05_SIMS_S_06_05_CaseMgmt_Work_STANDARD,
        sets.data_S_06_05_SIMS_S_06_05_CaseMgmt_Work_INSTRUCTIONS,
        sets.data_S_06_05_SIMS_S_06_05_CaseMgmt_Work_NA,
        sets.data_S_06_05_SIMS_S_06_05_CaseMgmt_Work_Q1_T_NUM,
        sets.data_S_06_05_SIMS_S_06_05_CaseMgmt_Work_Q2_T_NUM,
        sets.data_S_06_05_SIMS_S_06_05_CaseMgmt_Work_COMM,
        sets.data_S_06_05_SIMS_S_06_05_CaseMgmt_Work_SCORE,
        sets.data_S_06_06_SIMS_S_06_06_PrevHIVGirls_STANDARD,
        sets.data_S_06_06_SIMS_S_06_06_PrevHIVGirls_INSTRUCTIONS,
        sets.data_S_06_06_SIMS_S_06_06_PrevHIVGirls_NA,
        sets.data_S_06_06_SIMS_S_06_06_PrevHIVGirls_Q1_RESP,
        sets.data_S_06_06_SIMS_S_06_06_PrevHIVGirls_Q2_T_NUM,
        sets.data_S_06_06_SIMS_S_06_06_PrevHIVGirls_Q3_T_NUM,
        sets.data_S_06_06_SIMS_S_06_06_PrevHIVGirls_COMM,
        sets.data_S_06_06_SIMS_S_06_06_PrevHIVGirls_SCORE,
        sets.data_S_06_07_SIMS_S_06_07_HIVRefSyst_STANDARD,
        sets.data_S_06_07_SIMS_S_06_07_HIVRefSyst_INSTRUCTIONS,
        sets.data_S_06_07_SIMS_S_06_07_HIVRefSyst_NA,
        sets.data_S_06_07_SIMS_S_06_07_HIVRefSyst_Q1_RESP,
        sets.data_S_06_07_SIMS_S_06_07_HIVRefSyst_Q2_PERC_GRP_generated_table_list_label_79,
        sets.data_S_06_07_SIMS_S_06_07_HIVRefSyst_Q2_PERC_GRP_SIMS_S_06_07_HIVRefSyst_Q2_PERC,
        sets.data_S_06_07_SIMS_S_06_07_HIVRefSyst_Q2_PERC_GRP_SIMS_S_06_07_HIVRefSyst_Q2_NUM,
        sets.data_S_06_07_SIMS_S_06_07_HIVRefSyst_Q2_PERC_GRP_SIMS_S_06_07_HIVRefSyst_Q2_DEN,
        sets.data_S_06_07_SIMS_S_06_07_HIVRefSyst_Q3_PERC_GRP_generated_table_list_label_84,
        sets.data_S_06_07_SIMS_S_06_07_HIVRefSyst_Q3_PERC_GRP_SIMS_S_06_07_HIVRefSyst_Q3_PERC,
        sets.data_S_06_07_SIMS_S_06_07_HIVRefSyst_Q3_PERC_GRP_SIMS_S_06_07_HIVRefSyst_Q3_NUM,
        sets.data_S_06_07_SIMS_S_06_07_HIVRefSyst_Q3_PERC_GRP_SIMS_S_06_07_HIVRefSyst_Q3_DEN,
        sets.data_S_06_07_SIMS_S_06_07_HIVRefSyst_COMM,
        sets.data_S_06_07_SIMS_S_06_07_HIVRefSyst_SCORE,
        sets.data_S_06_08_SIMS_S_06_08_HIVServices_OVC_STANDARD,
        sets.data_S_06_08_SIMS_S_06_08_HIVServices_OVC_INSTRUCTIONS,
        sets.data_S_06_08_SIMS_S_06_08_HIVServices_OVC_NA,
        sets.data_S_06_08_SIMS_S_06_08_HIVServices_OVC_Q1_T_NUM,	
        sets.data_S_06_08_SIMS_S_06_08_HIVServices_OVC_Q2_PERC_GRP_generated_table_list_label_97,
        sets.data_S_06_08_SIMS_S_06_08_HIVServices_OVC_Q2_PERC_GRP_SIMS_S_06_08_HIVServices_OVC_Q2_PERC,
        sets.data_S_06_08_SIMS_S_06_08_HIVServices_OVC_Q2_PERC_GRP_SIMS_S_06_08_HIVServices_OVC_Q2_NUM,
        sets.data_S_06_08_SIMS_S_06_08_HIVServices_OVC_Q2_PERC_GRP_SIMS_S_06_08_HIVServices_OVC_Q2_DEN,
        sets.data_S_06_08_SIMS_S_06_08_HIVServices_OVC_Q3_PERC_GRP_generated_table_list_label_102,
        sets.data_S_06_08_SIMS_S_06_08_HIVServices_OVC_Q3_PERC_GRP_SIMS_S_06_08_HIVServices_OVC_Q3_PERC,
        sets.data_S_06_08_SIMS_S_06_08_HIVServices_OVC_Q3_PERC_GRP_SIMS_S_06_08_HIVServices_OVC_Q3_NUM,
        sets.data_S_06_08_SIMS_S_06_08_HIVServices_OVC_Q3_PERC_GRP_SIMS_S_06_08_HIVServices_OVC_Q3_DEN,
        sets.data_S_06_08_SIMS_S_06_08_HIVServices_OVC_Q4_PERC_GRP_generated_table_list_label_107,
        sets.data_S_06_08_SIMS_S_06_08_HIVServices_OVC_Q4_PERC_GRP_SIMS_S_06_08_HIVServices_OVC_Q4_PERC,
        sets.data_S_06_08_SIMS_S_06_08_HIVServices_OVC_Q4_PERC_GRP_SIMS_S_06_08_HIVServices_OVC_Q4_NUM,
        sets.data_S_06_08_SIMS_S_06_08_HIVServices_OVC_Q4_PERC_GRP_SIMS_S_06_08_HIVServices_OVC_Q4_DEN,
        sets.data_S_06_08_SIMS_S_06_08_HIVServices_OVC_COMM,
        sets.data_S_06_08_SIMS_S_06_08_HIVServices_OVC_SCORE,
        sets.data_meta_instanceID,
        sets.data_meta_instanceName,
        sets.Facility,
        sets.meta_details,
        sets.data_S_06_01_SIMS_S_06_01_PostViolCap_GBV_SCORE_grade,
        sets.data_S_06_02_SIMS_S_06_02_PostViolAvail_GBV_SCORE_grade,
        sets.data_S_06_03_SIMS_S_06_03_GenNorm_SCORE_grade,
        sets.data_S_06_04_SIMS_S_06_04_CaseMgmt_Serv_SCORE_grade,
        sets.data_S_06_05_SIMS_S_06_05_CaseMgmt_Work_SCORE_grade,
        sets.data_S_06_06_SIMS_S_06_06_PrevHIVGirls_SCORE_grade,
        sets.data_S_06_07_SIMS_S_06_07_HIVRefSyst_SCORE_grade,
        sets.data_S_06_08_SIMS_S_06_08_HIVServices_OVC_SCORE_grade,
        sets.Set_Average,
        sets.Expected_Average,
        sets.Average_Score,
        sets.Set_ID,
        hubs.Hub
        FROM `{PROJECT_ID}.{STAGING_DATASET}.S_6test` as sets
        LEFT JOIN `{PROJECT_ID}.MFL.hub_details` as hubs
        ON cast(sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_FACILITY_MFL as int64) = hubs.MFL_Code
        ''',
        destination_dataset_table = f'{PROJECT_ID}:{STAGING_DATASET}.S_6test',
        write_disposition='WRITE_TRUNCATE',
        allow_large_results=True,
        use_legacy_sql=False,
        dag=dag
    )

    t11 = BigQueryOperator(
        task_id='S7_hubs',
        sql=f'''
        SELECT
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASSR_NAME,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_COUNTY,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_SUB_COUNTY,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_FACILITY,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_FACILITY_MFL,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_TYPE,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_DATE,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_START_TIME,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_END_TIME,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_LOCATION,
        sets.data_S_07_01_SIMS_S_07_01_NatAlgor_HTS_STANDARD,
        sets.data_S_07_01_SIMS_S_07_01_NatAlgor_HTS_INSTRUCTIONS,
        sets.data_S_07_01_SIMS_S_07_01_NatAlgor_HTS_Q1_RESP,
        sets.data_S_07_01_SIMS_S_07_01_NatAlgor_HTS_Q2_T_NUM,	
        sets.data_S_07_01_SIMS_S_07_01_NatAlgor_HTS_Q3_PERC_GRP_generated_table_list_label_19,
        sets.data_S_07_01_SIMS_S_07_01_NatAlgor_HTS_Q3_PERC_GRP_SIMS_S_07_01_NatAlgor_HTS_Q3_PERC,
        sets.data_S_07_01_SIMS_S_07_01_NatAlgor_HTS_Q3_PERC_GRP_SIMS_S_07_01_NatAlgor_HTS_Q3_NUM,
        sets.data_S_07_01_SIMS_S_07_01_NatAlgor_HTS_Q3_PERC_GRP_SIMS_S_07_01_NatAlgor_HTS_Q3_DEN,
        sets.data_S_07_01_SIMS_S_07_01_NatAlgor_HTS_COMM,
        sets.data_S_07_01_SIMS_S_07_01_NatAlgor_HTS_SCORE,
        sets.data_S_07_02_SIMS_S_07_02_QA_HTS_STANDARD,
        sets.data_S_07_02_SIMS_S_07_02_QA_HTS_Q1_RESP,
        sets.data_S_07_02_SIMS_S_07_02_QA_HTS_Q2_RESP,
        sets.data_S_07_02_SIMS_S_07_02_QA_HTS_Q3_RESP,
        sets.data_S_07_02_SIMS_S_07_02_QA_HTS_COMM,
        sets.data_S_07_02_SIMS_S_07_02_QA_HTS_SCORE,
        sets.data_S_07_03_SIMS_S_07_03_RefHIV_CTx_STANDARD,
        sets.data_S_07_03_SIMS_S_07_03_RefHIV_CTx_Q1_RESP,
        sets.data_S_07_03_SIMS_S_07_03_RefHIV_CTx_Q2_RESP,
        sets.data_S_07_03_SIMS_S_07_03_RefHIV_CTx_Q3_RESP,	
        sets.data_S_07_03_SIMS_S_07_03_RefHIV_CTx_Q4_PERC_GRP_generated_table_list_label_40,	
        sets.data_S_07_03_SIMS_S_07_03_RefHIV_CTx_Q4_PERC_GRP_SIMS_S_07_03_RefHIV_CTx_Q4_PERC,
        sets.data_S_07_03_SIMS_S_07_03_RefHIV_CTx_Q4_PERC_GRP_SIMS_S_07_03_RefHIV_CTx_Q4_NUM,
        sets.data_S_07_03_SIMS_S_07_03_RefHIV_CTx_Q4_PERC_GRP_SIMS_S_07_03_RefHIV_CTx_Q4_DEN,	
        sets.data_S_07_03_SIMS_S_07_03_RefHIV_CTx_COMM,
        sets.data_S_07_03_SIMS_S_07_03_RefHIV_CTx_SCORE,
        sets.data_S_07_04_SIMS_S_07_04_PT_HTS_STANDARD,
        sets.data_S_07_04_SIMS_S_07_04_PT_HTS_INSTRUCTIONS,
        sets.data_S_07_04_SIMS_S_07_04_PT_HTS_NA,
        sets.data_S_07_04_SIMS_S_07_04_PT_HTS_Q1_RESP,
        sets.data_S_07_04_SIMS_S_07_04_PT_HTS_Q2_PERC_GRP_generated_table_list_label_53,
        sets.data_S_07_04_SIMS_S_07_04_PT_HTS_Q2_PERC_GRP_SIMS_S_07_04_PT_HTS_Q2_PERC,
        sets.data_S_07_04_SIMS_S_07_04_PT_HTS_Q2_PERC_GRP_SIMS_S_07_04_PT_HTS_Q2_NUM,
        sets.data_S_07_04_SIMS_S_07_04_PT_HTS_Q2_PERC_GRP_SIMS_S_07_04_PT_HTS_Q2_DEN,
        sets.data_S_07_04_SIMS_S_07_04_PT_HTS_Q3_A_NUM,
        sets.data_S_07_04_SIMS_S_07_04_PT_HTS_COMM,
        sets.data_S_07_04_SIMS_S_07_04_PT_HTS_SCORE,
        sets.data_S_07_05_SIMS_S_07_05_HTS_Sfty_SDP_STANDARD,
        sets.data_S_07_05_SIMS_S_07_05_HTS_Sfty_SDP_Q1_T_NUM,
        sets.data_S_07_05_SIMS_S_07_05_HTS_Sfty_SDP_Q2_RESP,
        sets.data_S_07_05_SIMS_S_07_05_HTS_Sfty_SDP_Q3_RESP,
        sets.data_S_07_05_SIMS_S_07_05_HTS_Sfty_SDP_COMM,
        sets.data_S_07_05_SIMS_S_07_05_HTS_Sfty_SDP_SCORE,
        sets.data_S_07_06_SIMS_S_07_06_Conf_HIV_Tst_SDP_STANDARD,
        sets.data_S_07_06_SIMS_S_07_06_Conf_HIV_Tst_SDP_Q1_RESP,
        sets.data_S_07_06_SIMS_S_07_06_Conf_HIV_Tst_SDP_Q2_RESP,
        sets.data_S_07_06_SIMS_S_07_06_Conf_HIV_Tst_SDP_Q3_RESP,
        sets.data_S_07_06_SIMS_S_07_06_Conf_HIV_Tst_SDP_COMM,
        sets.data_S_07_06_SIMS_S_07_06_Conf_HIV_Tst_SDP_SCORE,
        sets.data_S_07_07_SIMS_S_07_07_SelfTst_STANDARD,
        sets.data_S_07_07_SIMS_S_07_07_SelfTst_INSTRUCTIONS,
        sets.data_S_07_07_SIMS_S_07_07_SelfTst_NA,
        sets.data_S_07_07_SIMS_S_07_07_SelfTst_Q1_RESP,
        sets.data_S_07_07_SIMS_S_07_07_SelfTst_Q2_RESP,
        sets.data_S_07_07_SIMS_S_07_07_SelfTst_COMM,
        sets.data_S_07_07_SIMS_S_07_07_SelfTst_SCORE,
        sets.data_S_07_08_SIMS_S_07_08_Train_and_Sup_IndexTst_STANDARD,	
        sets.data_S_07_08_SIMS_S_07_08_Train_and_Sup_IndexTst_INSTRUCTIONS,	
        sets.data_S_07_08_SIMS_S_07_08_Train_and_Sup_IndexTst_Q1_RESP,	
        sets.data_S_07_08_SIMS_S_07_08_Train_and_Sup_IndexTst_Q2_PERC_GRP_generated_table_list_label_91,
        sets.data_S_07_08_SIMS_S_07_08_Train_and_Sup_IndexTst_Q2_PERC_GRP_SIMS_S_07_08_Train_and_Sup_IndexTst_Q2_PERC,
        sets.data_S_07_08_SIMS_S_07_08_Train_and_Sup_IndexTst_Q2_PERC_GRP_SIMS_S_07_08_Train_and_Sup_IndexTst_Q2_NUM,
        sets.data_S_07_08_SIMS_S_07_08_Train_and_Sup_IndexTst_Q2_PERC_GRP_SIMS_S_07_08_Train_and_Sup_IndexTst_Q2_DEN,
        sets.data_S_07_08_SIMS_S_07_08_Train_and_Sup_IndexTst_Q3_RESP,
        sets.data_S_07_08_SIMS_S_07_08_Train_and_Sup_IndexTst_Q4_RESP,
        sets.data_S_07_08_SIMS_S_07_08_Train_and_Sup_IndexTst_COMM,
        sets.data_S_07_08_SIMS_S_07_08_Train_and_Sup_IndexTst_SCORE,
        sets.data_S_07_09_SIMS_S_07_09_MonAE_IndexTst_STANDARD,
        sets.data_S_07_09_SIMS_S_07_09_MonAE_IndexTst_INSTRUCTIONS,
        sets.data_S_07_09_SIMS_S_07_09_MonAE_IndexTst_Q1_RESP,
        sets.data_S_07_09_SIMS_S_07_09_MonAE_IndexTst_Q2_RESP,
        sets.data_S_07_09_SIMS_S_07_09_MonAE_IndexTst_Q3_RESP,
        sets.data_S_07_09_SIMS_S_07_09_MonAE_IndexTst_COMM,
        sets.data_S_07_09_SIMS_S_07_09_MonAE_IndexTst_SCORE,
        sets.data_S_07_10_SIMS_S_07_10_SecHand_and_Stor_IndexTst_STANDARD,	
        sets.data_S_07_10_SIMS_S_07_10_SecHand_and_Stor_IndexTst_INSTRUCTIONS,	
        sets.data_S_07_10_SIMS_S_07_10_SecHand_and_Stor_IndexTst_Q1_RESP,
        sets.data_S_07_10_SIMS_S_07_10_SecHand_and_Stor_IndexTst_Q2_RESP,
        sets.data_S_07_10_SIMS_S_07_10_SecHand_and_Stor_IndexTst_Q3_RESP,
        sets.data_S_07_10_SIMS_S_07_10_SecHand_and_Stor_IndexTst_COMM,
        sets.data_S_07_10_SIMS_S_07_10_SecHand_and_Stor_IndexTst_SCORE,	
        sets.data_S_07_11_SIMS_S_07_11_IPV_RiskAsmt_STANDARD,
        sets.data_S_07_11_SIMS_S_07_11_IPV_RiskAsmt_INSTRUCTIONS,
        sets.data_S_07_11_SIMS_S_07_11_IPV_RiskAsmt_Q1_RESP,
        sets.data_S_07_11_SIMS_S_07_11_IPV_RiskAsmt_Q2_RESP,
        sets.data_S_07_11_SIMS_S_07_11_IPV_RiskAsmt_Q3_RESP,
        sets.data_S_07_11_SIMS_S_07_11_IPV_RiskAsmt_Q4_RESP,
        sets.data_S_07_11_SIMS_S_07_11_IPV_RiskAsmt_Q5_RESP,
        sets.data_S_07_11_SIMS_S_07_11_IPV_RiskAsmt_COMM,
        sets.data_S_07_11_SIMS_S_07_11_IPV_RiskAsmt_SCORE,
        sets.data_meta_instanceID,
        sets.data_meta_instanceName,
        sets.Facility,
        sets.meta_details,
        sets.data_S_07_01_SIMS_S_07_01_NatAlgor_HTS_SCORE_grade,
        sets.data_S_07_02_SIMS_S_07_02_QA_HTS_SCORE_grade,
        sets.data_S_07_03_SIMS_S_07_03_RefHIV_CTx_SCORE_grade,
        sets.data_S_07_04_SIMS_S_07_04_PT_HTS_SCORE_grade,
        sets.data_S_07_05_SIMS_S_07_05_HTS_Sfty_SDP_SCORE_grade,
        sets.data_S_07_06_SIMS_S_07_06_Conf_HIV_Tst_SDP_SCORE_grade,
        sets.data_S_07_07_SIMS_S_07_07_SelfTst_SCORE_grade,
        sets.data_S_07_08_SIMS_S_07_08_Train_and_Sup_IndexTst_SCORE_grade,
        sets.data_S_07_09_SIMS_S_07_09_MonAE_IndexTst_SCORE_grade,
        sets.data_S_07_10_SIMS_S_07_10_SecHand_and_Stor_IndexTst_SCORE_grade,
        sets.data_S_07_11_SIMS_S_07_11_IPV_RiskAsmt_SCORE_grade,
        sets.Set_Average,
        sets.Expected_Average,
        sets.Average_Score,
        sets.Set_ID,
        hubs.Hub
        FROM `{PROJECT_ID}.{STAGING_DATASET}.S_7test` as sets
        LEFT JOIN `{PROJECT_ID}.MFL.hub_details` as hubs
        ON cast(sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_FACILITY_MFL as int64) = hubs.MFL_Code
        ''',
        destination_dataset_table = f'{PROJECT_ID}:{STAGING_DATASET}.S_7test',
        write_disposition='WRITE_TRUNCATE',
        allow_large_results=True,
        use_legacy_sql=False,
        dag=dag
    )

    t12 = BigQueryOperator(
        task_id='S8_hubs',
        sql=f'''
        SELECT
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASSR_NAME,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_COUNTY,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_SUB_COUNTY,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_FACILITY,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_FACILITY_MFL,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_TYPE,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_DATE,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_START_TIME,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_END_TIME,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_LOCATION,
        sets.data_S_08_01_SIMS_S_08_01_PITC_TB_STANDARD,
        sets.data_S_08_01_SIMS_S_08_01_PITC_TB_INSTR_A_NUM,
        sets.data_S_08_01_SIMS_S_08_01_PITC_TB_Q1_RESP,
        sets.data_S_08_01_SIMS_S_08_01_PITC_TB_Q2_PERC_GRP_generated_table_list_label_18,
        sets.data_S_08_01_SIMS_S_08_01_PITC_TB_Q2_PERC_GRP_SIMS_S_08_01_PITC_TB_Q2_PERC,
        sets.data_S_08_01_SIMS_S_08_01_PITC_TB_Q2_PERC_GRP_SIMS_S_08_01_PITC_TB_Q2_NUM,
        sets.data_S_08_01_SIMS_S_08_01_PITC_TB_Q2_PERC_GRP_SIMS_S_08_01_PITC_TB_Q2_DEN,
        sets.data_S_08_01_SIMS_S_08_01_PITC_TB_COMM,
        sets.data_S_08_01_SIMS_S_08_01_PITC_TB_SCORE,
        sets.data_S_08_02_SIMS_S_08_02_ART_TB_STANDARD,
        sets.data_S_08_02_SIMS_S_08_02_ART_TB_INSTR_A_NUM,
        sets.data_S_08_02_SIMS_S_08_02_ART_TB_Q1_RESP,
        sets.data_S_08_02_SIMS_S_08_02_ART_TB_Q2_PERC_GRP_generated_table_list_label_30,
        sets.data_S_08_02_SIMS_S_08_02_ART_TB_Q2_PERC_GRP_SIMS_S_08_02_ART_TB_Q2_PERC,
        sets.data_S_08_02_SIMS_S_08_02_ART_TB_Q2_PERC_GRP_SIMS_S_08_02_ART_TB_Q2_NUM,
        sets.data_S_08_02_SIMS_S_08_02_ART_TB_Q2_PERC_GRP_SIMS_S_08_02_ART_TB_Q2_DEN,
        sets.data_S_08_02_SIMS_S_08_02_ART_TB_COMM,
        sets.data_S_08_02_SIMS_S_08_02_ART_TB_SCORE,
        sets.data_meta_instanceID,
        sets.data_meta_instanceName,
        sets.Facility,
        sets.meta_details,
        sets.data_S_08_01_SIMS_S_08_01_PITC_TB_SCORE_grade,
        sets.data_S_08_02_SIMS_S_08_02_ART_TB_SCORE_grade,
        sets.Set_Average,
        sets.Expected_Average,
        sets.Average_Score,
        sets.Set_ID,
        hubs.Hub
        FROM `{PROJECT_ID}.{STAGING_DATASET}.S_8test` as sets
        LEFT JOIN `{PROJECT_ID}.MFL.hub_details` as hubs
        ON cast(sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_FACILITY_MFL as int64) = hubs.MFL_Code
        ''',
        destination_dataset_table = f'{PROJECT_ID}:{STAGING_DATASET}.S_8test',
        write_disposition='WRITE_TRUNCATE',
        allow_large_results=True,
        use_legacy_sql=False,
        dag=dag
    )

    t13 = BigQueryOperator(
        task_id='S10A_hubs',
        sql=f'''
        SELECT
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASSR_NAME, 
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_COUNTY, 
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_SUB_COUNTY, 
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_FACILITY, 
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_FACILITY_MFL, 
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_TYPE,	
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_DATE, 
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_START_TIME, 
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_END_TIME, 
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_LOCATION, 
        sets.data_S_10_01_SIMS_S_10_01_QMS_LAB_STANDARD,	
        sets.data_S_10_01_SIMS_S_10_01_QMS_LAB_Q1_T_NUM, 
        sets.data_S_10_01_SIMS_S_10_01_QMS_LAB_Q2_T_NUM,	
        sets.data_S_10_01_SIMS_S_10_01_QMS_LAB_COMM, 
        sets.data_S_10_01_SIMS_S_10_01_QMS_LAB_SCORE, 
        sets.data_S_10_02_SIMS_S_10_02_BioSafe_LAB_STANDARD,	
        sets.data_S_10_02_SIMS_S_10_02_BioSafe_LAB_Q1_T_NUM,	
        sets.data_S_10_02_SIMS_S_10_02_BioSafe_LAB_Q2_RESP, 
        sets.data_S_10_02_SIMS_S_10_02_BioSafe_LAB_Q3_RESP,	
        sets.data_S_10_02_SIMS_S_10_02_BioSafe_LAB_COMM,	
        sets.data_S_10_02_SIMS_S_10_02_BioSafe_LAB_SCORE, 
        sets.data_S_10_03_SIMS_S_10_03_SOP_LAB_STANDARD,	
        sets.data_S_10_03_SIMS_S_10_03_SOP_LAB_Q1_PERC_GRP_generated_table_list_label_31, 
        sets.data_S_10_03_SIMS_S_10_03_SOP_LAB_Q1_PERC_GRP_SIMS_S_10_03_SOP_LAB_Q1_PERC,	
        sets.data_S_10_03_SIMS_S_10_03_SOP_LAB_Q1_PERC_GRP_SIMS_S_10_03_SOP_LAB_Q1_NUM, 
        sets.data_S_10_03_SIMS_S_10_03_SOP_LAB_Q1_PERC_GRP_SIMS_S_10_03_SOP_LAB_Q1_DEN,	
        sets.data_S_10_03_SIMS_S_10_03_SOP_LAB_Q2_RESP,	
        sets.data_S_10_03_SIMS_S_10_03_SOP_LAB_COMM, 
        sets.data_S_10_03_SIMS_S_10_03_SOP_LAB_SCORE,	
        sets.data_S_10_04_SIMS_S_10_04_QualTestMon_LAB_STANDARD, 
        sets.data_S_10_04_SIMS_S_10_04_QualTestMon_LAB_Q1_PERC_GRP_generated_table_list_label_42, 
        sets.data_S_10_04_SIMS_S_10_04_QualTestMon_LAB_Q1_PERC_GRP_SIMS_S_10_04_QualTestMon_LAB_Q1_PERC, 
        sets.data_S_10_04_SIMS_S_10_04_QualTestMon_LAB_Q1_PERC_GRP_SIMS_S_10_04_QualTestMon_LAB_Q1_NUM, 
        sets.data_S_10_04_SIMS_S_10_04_QualTestMon_LAB_Q1_PERC_GRP_SIMS_S_10_04_QualTestMon_LAB_Q1_DEN,	
        sets.data_S_10_04_SIMS_S_10_04_QualTestMon_LAB_Q2_PERC_GRP_generated_table_list_label_47,	
        sets.data_S_10_04_SIMS_S_10_04_QualTestMon_LAB_Q2_PERC_GRP_SIMS_S_10_04_QualTestMon_LAB_Q2_PERC,	
        sets.data_S_10_04_SIMS_S_10_04_QualTestMon_LAB_Q2_PERC_GRP_SIMS_S_10_04_QualTestMon_LAB_Q2_NUM,	
        sets.data_S_10_04_SIMS_S_10_04_QualTestMon_LAB_Q2_PERC_GRP_SIMS_S_10_04_QualTestMon_LAB_Q2_DEN,	
        sets.data_S_10_04_SIMS_S_10_04_QualTestMon_LAB_Q3_A_NUM,	
        sets.data_S_10_04_SIMS_S_10_04_QualTestMon_LAB_COMM,	
        sets.data_S_10_04_SIMS_S_10_04_QualTestMon_LAB_SCORE,	
        sets.data_S_10_05_SIMS_S_10_05_TestInterupt_LAB_STANDARD,	
        sets.data_S_10_05_SIMS_S_10_05_TestInterupt_LAB_Q1_T_NUM,	
        sets.data_S_10_05_SIMS_S_10_05_TestInterupt_LAB_Q2_RESP,	
        sets.data_S_10_05_SIMS_S_10_05_TestInterupt_LAB_COMM,	
        sets.data_S_10_05_SIMS_S_10_05_TestInterupt_LAB_SCORE,	
        sets.data_S_10_06_SIMS_S_10_06_WasteMan_LAB_STANDARD,	
        sets.data_S_10_06_SIMS_S_10_06_WasteMan_LAB_INSTRUCTIONS,	
        sets.data_S_10_06_SIMS_S_10_06_WasteMan_LAB_NA,	
        sets.data_S_10_06_SIMS_S_10_06_WasteMan_LAB_Q1_RESP,	
        sets.data_S_10_06_SIMS_S_10_06_WasteMan_LAB_Q2_RESP,	
        sets.data_S_10_06_SIMS_S_10_06_WasteMan_LAB_Q3_T_NUM,	
        sets.data_S_10_06_SIMS_S_10_06_WasteMan_LAB_COMM,	
        sets.data_S_10_06_SIMS_S_10_06_WasteMan_LAB_SCORE,	
        sets.data_S_10_07_SIMS_S_10_07_InjSafe_LAB_STANDARD,	
        sets.data_S_10_07_SIMS_S_10_07_InjSafe_LAB_INSTRUCTIONS,	
        sets.data_S_10_07_SIMS_S_10_07_InjSafe_LAB_NA	data_S_10_07_SIMS_S_10_07_InjSafe_LAB_Q1_T_NUM,	
        sets.data_S_10_07_SIMS_S_10_07_InjSafe_LAB_Q2_RESP,	
        sets.data_S_10_07_SIMS_S_10_07_InjSafe_LAB_Q3_RESP,	
        sets.data_S_10_07_SIMS_S_10_07_InjSafe_LAB_Q4_RESP,	
        sets.data_S_10_07_SIMS_S_10_07_InjSafe_LAB_COMM,	
        sets.data_S_10_07_SIMS_S_10_07_InjSafe_LAB_SCORE,	
        sets.data_S_10_08_SIMS_S_10_08_ViralLoadCap_STANDARD,	
        sets.data_S_10_08_SIMS_S_10_08_ViralLoadCap_INSTRUCTIONS,	
        sets.data_S_10_08_SIMS_S_10_08_ViralLoadCap_NA,	
        sets.data_S_10_08_SIMS_S_10_08_ViralLoadCap_Q1_T_NUM,	
        sets.data_S_10_08_SIMS_S_10_08_ViralLoadCap_Q2_T_NUM,	
        sets.data_S_10_08_SIMS_S_10_08_ViralLoadCap_COMM,	
        sets.data_S_10_08_SIMS_S_10_08_ViralLoadCap_SCORE,	
        sets.data_S_10_09_SIMS_S_10_09_ViralLoadSpecRef_STANDARD,	
        sets.data_S_10_09_SIMS_S_10_09_ViralLoadSpecRef_INSTRUCTIONS,	
        sets.data_S_10_09_SIMS_S_10_09_ViralLoadSpecRef_NA,	
        sets.data_S_10_09_SIMS_S_10_09_ViralLoadSpecRef_Q1_T_NUM,	
        sets.data_S_10_09_SIMS_S_10_09_ViralLoadSpecRef_Q2_T_NUM,	
        sets.data_S_10_09_SIMS_S_10_09_ViralLoadSpecRef_COMM,	
        sets.data_S_10_09_SIMS_S_10_09_ViralLoadSpecRef_SCORE,	
        sets.data_meta_instanceID,	
        sets.data_meta_instanceName,	
        sets.Facility, sets.meta_details,	
        sets.data_S_10_01_SIMS_S_10_01_QMS_LAB_SCORE_grade,	
        sets.data_S_10_02_SIMS_S_10_02_BioSafe_LAB_SCORE_grade,	
        sets.data_S_10_03_SIMS_S_10_03_SOP_LAB_SCORE_grade,	
        sets.data_S_10_04_SIMS_S_10_04_QualTestMon_LAB_SCORE_grade,	
        sets.data_S_10_05_SIMS_S_10_05_TestInterupt_LAB_SCORE_grade,	
        sets.data_S_10_06_SIMS_S_10_06_WasteMan_LAB_SCORE_grade,	
        sets.data_S_10_07_SIMS_S_10_07_InjSafe_LAB_SCORE_grade,	
        sets.data_S_10_08_SIMS_S_10_08_ViralLoadCap_SCORE_grade,	
        sets.data_S_10_09_SIMS_S_10_09_ViralLoadSpecRef_SCORE_grade,	
        sets.Set_Average,	
        sets.Expected_Average,	
        sets.Average_Score,	
        sets.Set_ID, 
        hubs.Hub
        FROM `{PROJECT_ID}.{STAGING_DATASET}.S_10Atest` as sets
        LEFT JOIN `{PROJECT_ID}.MFL.hub_details` as hubs
        ON cast(sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_FACILITY_MFL as int64) = hubs.MFL_Code
        ''',
        destination_dataset_table = f'{PROJECT_ID}:{STAGING_DATASET}.S_10Atest',
        write_disposition='WRITE_TRUNCATE',
        allow_large_results=True,
        use_legacy_sql=False,
        dag=dag
    )

    t14 = BigQueryOperator(
        task_id='S10B_hubs',
        sql=f'''
        SELECT
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASSR_NAME,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_COUNTY,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_SUB_COUNTY,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_FACILITY,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_FACILITY_MFL,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_TYPE,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_DATE,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_START_TIME,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_END_TIME,
        sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_LOCATION,
        sets.data_S_10_10_SIMS_S_10_10_SafeBlood_LAB_STANDARD,
        sets.data_S_10_10_SIMS_S_10_10_SafeBlood_LAB_INSTRUCTIONS,
        sets.data_S_10_10_SIMS_S_10_10_SafeBlood_LAB_NA,
        sets.data_S_10_10_SIMS_S_10_10_SafeBlood_LAB_Q1_T_NUM,
        sets.data_S_10_10_SIMS_S_10_10_SafeBlood_LAB_Q2_T_NUM,
        sets.data_S_10_10_SIMS_S_10_10_SafeBlood_LAB_COMM,
        sets.data_S_10_10_SIMS_S_10_10_SafeBlood_LAB_SCORE,
        sets.data_S_10_11_SIMS_S_10_11_BloodBnk_Linkage_STANDARD,
        sets.data_S_10_11_SIMS_S_10_11_BloodBnk_Linkage_Q1_RESP,
        sets.data_S_10_11_SIMS_S_10_11_BloodBnk_Linkage_Q2_RESP,
        sets.data_S_10_11_SIMS_S_10_11_BloodBnk_Linkage_Q3_RESP,
        sets.data_S_10_11_SIMS_S_10_11_BloodBnk_Linkage_COMM,
        sets.data_S_10_11_SIMS_S_10_11_BloodBnk_Linkage_SCORE,
        sets.data_meta_instanceID,
        sets.data_meta_instanceName,
        sets.Facility,
        sets.meta_details,
        sets.data_S_10_10_SIMS_S_10_10_SafeBlood_LAB_SCORE_grade,
        sets.data_S_10_11_SIMS_S_10_11_BloodBnk_Linkage_SCORE_grade,
        sets.Set_Average,
        sets.Expected_Average,
        sets.Average_Score,
        sets.Set_ID,
        hubs.Hub
        FROM `{PROJECT_ID}.{STAGING_DATASET}.S_10Btest` as sets
        LEFT JOIN `{PROJECT_ID}.MFL.hub_details` as hubs
        ON cast(sets.data_SIMS_ASSESSMENT_DETAILS_SIMS_CS_ASMT_FACILITY_MFL as int64) = hubs.MFL_Code
        ''',
        destination_dataset_table = f'{PROJECT_ID}:{STAGING_DATASET}.S_10Btest',
        write_disposition='WRITE_TRUNCATE',
        allow_large_results=True,
        use_legacy_sql=False,
        dag=dag
    )

t1 >> t2 >> t3 >> t4 >> t5 >> t6 >> t7 >> t8 >> t9 >> t10 >> t11 >> t12 >> t13 >> t14